<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.38">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="16x16" href="/img/logo/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/logo/favicon-32x32.png"><meta name="application-name" content="Louis Young"><meta name="apple-mobile-web-app-title" content="Louis Young"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/img/logo/apple-touch-icon.png"><meta name="theme-color" content="#377bb5"><meta name="msapplication-TileColor" content="#377bb5"><title>Research on human vitals feature mobile application | Louis Young (@louisyoungx)</title><meta name="description" content="Louis Young a Web developer and Python full stack developer.">
    <link rel="modulepreload" href="/assets/app.f5ce6765.js"><link rel="modulepreload" href="/assets/index.html.9b26993b.js"><link rel="modulepreload" href="/assets/index.html.d1b08c1b.js">
    <link rel="stylesheet" href="/assets/style.c3732583.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar invert"><span><a href="/" class=""><span class="site-name">$ cd /home/</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/about/" class="" aria-label="About"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg></span><span>About</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="Tags"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg></span><span>Tags</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/louisyoungx/" rel="noopener noreferrer" target="_blank" aria-label="Portfolio"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path fill-rule="evenodd" d="M14.064 0a8.75 8.75 0 00-6.187 2.563l-.459.458c-.314.314-.616.641-.904.979H3.31a1.75 1.75 0 00-1.49.833L.11 7.607a.75.75 0 00.418 1.11l3.102.954c.037.051.079.1.124.145l2.429 2.428c.046.046.094.088.145.125l.954 3.102a.75.75 0 001.11.418l2.774-1.707a1.75 1.75 0 00.833-1.49V9.485c.338-.288.665-.59.979-.904l.458-.459A8.75 8.75 0 0016 1.936V1.75A1.75 1.75 0 0014.25 0h-.186zM10.5 10.625c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 00.119-.213v-2.066zM3.678 8.116L5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 00-.213.119l-1.2 1.95 1.782.547zm5.26-4.493A7.25 7.25 0 0114.063 1.5h.186a.25.25 0 01.25.25v.186a7.25 7.25 0 01-2.123 5.127l-.459.458a15.21 15.21 0 01-2.499 2.02l-2.317 1.5-2.143-2.143 1.5-2.317a15.25 15.25 0 012.02-2.5l.458-.458h.002zM12 5a1 1 0 11-2 0 1 1 0 012 0zm-8.44 9.56a1.5 1.5 0 10-2.12-2.12c-.734.73-1.047 2.332-1.15 3.003a.23.23 0 00.265.265c.671-.103 2.273-.416 3.005-1.148z"/></svg></span><span>Portfolio</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg></span><span>Home</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/about/" class="" aria-label="About"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg></span><span>About</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="Tags"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg></span><span>Tags</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/louisyoungx/" rel="noopener noreferrer" target="_blank" aria-label="Portfolio"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path fill-rule="evenodd" d="M14.064 0a8.75 8.75 0 00-6.187 2.563l-.459.458c-.314.314-.616.641-.904.979H3.31a1.75 1.75 0 00-1.49.833L.11 7.607a.75.75 0 00.418 1.11l3.102.954c.037.051.079.1.124.145l2.429 2.428c.046.046.094.088.145.125l.954 3.102a.75.75 0 001.11.418l2.774-1.707a1.75 1.75 0 00.833-1.49V9.485c.338-.288.665-.59.979-.904l.458-.459A8.75 8.75 0 0016 1.936V1.75A1.75 1.75 0 0014.25 0h-.186zM10.5 10.625c-.088.06-.177.118-.266.175l-2.35 1.521.548 1.783 1.949-1.2a.25.25 0 00.119-.213v-2.066zM3.678 8.116L5.2 5.766c.058-.09.117-.178.176-.266H3.309a.25.25 0 00-.213.119l-1.2 1.95 1.782.547zm5.26-4.493A7.25 7.25 0 0114.063 1.5h.186a.25.25 0 01.25.25v.186a7.25 7.25 0 01-2.123 5.127l-.459.458a15.21 15.21 0 01-2.499 2.02l-2.317 1.5-2.143-2.143 1.5-2.317a15.25 15.25 0 012.02-2.5l.458-.458h.002zM12 5a1 1 0 11-2 0 1 1 0 012 0zm-8.44 9.56a1.5 1.5 0 10-2.12-2.12c-.734.73-1.047 2.332-1.15 3.003a.23.23 0 00.265.265c.671-.103 2.273-.416 3.005-1.148z"/></svg></span><span>Portfolio</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>Search</span></a></div></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><div class="page-content"><!--[--><div class="post-wrapper show-catalog"><div class="article-header use-image post-header" style="background-image:url(/img/in-post/2022-05-13/header.jpg);"><div class="article-header-mask" style="background:rgb(14, 21, 5, .2);"></div><div class="article-header-content"><div class="article-tags"><!--[--><span class="article-tag">technology</span><span class="article-tag">chinese</span><span class="article-tag">web</span><span class="article-tag">vue.js</span><span class="article-tag">javascript</span><!--]--></div><h1 class="article-title">Research on human vitals feature mobile application</h1><p class="article-subtitle">based on fiber optic sensing</p><div class="article-icons"><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewbox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg><span>louisyoungx</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewbox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg><span>2022-05-13</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewbox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg><span>79 min</span></div></div></div><!----></div><main class="page post-content"><!--[--><!--]--><div class="theme-gungnir-content"><!--[--><p>human vital features Mobile Application using JavaScript programming language based on the principle of fiber optic sensing.</p><h1 id="面向光纤传感的人体生命体特征手机app研究" tabindex="-1"><a class="header-anchor" href="#面向光纤传感的人体生命体特征手机app研究" aria-hidden="true">#</a> 面向光纤传感的人体生命体特征手机APP研究</h1><h2 id="摘要" tabindex="-1"><a class="header-anchor" href="#摘要" aria-hidden="true">#</a> 摘要</h2><p>人口老龄化和生活水平的提高是当今中国社会发展的重要趋势。心血管疾病的患病率不断上升，给人们的生活带来了严重的健康隐患。智能监测设备和可穿戴设备可用于日常监测人们的生理信号，为疾病的诊断和预防提供重要的参考价值。通过对生理信号特征的评估和研究，可一定程度上对疾病进行预测和防范。因此通过便携式设备实现对脉搏特征的可靠测量对于心血管疾病的预防和诊断，从而降低心血管死亡率有很大的意义。</p><p>考虑到移动通信设备同时具有便捷性和可拓展性，本文基于光纤传感脉搏信号采集原理，采用JavaScript技术栈实现了一套高可用的人体生命体特征手机APP与服务器系统。此APP能接收服务器中转的脉搏数据流并据此绘制脉搏波形图，并基于脉搏数据提取人体生物特征，且能基于此类特征进行实时展示或进行历史数据分析。</p><p><strong>关键词</strong>: <em>光纤传感器；脉搏波特征；血压和脉搏传播时间；APP；JavaScript</em></p><h1 id="research-on-human-vitals-feature-mobile-application-based-on-fiber-optic-sensing" tabindex="-1"><a class="header-anchor" href="#research-on-human-vitals-feature-mobile-application-based-on-fiber-optic-sensing" aria-hidden="true">#</a> Research on human vitals feature mobile application based on fiber optic sensing</h1><h2 id="abstract" tabindex="-1"><a class="header-anchor" href="#abstract" aria-hidden="true">#</a> Abstract</h2><p>Nowadays, the important trend of China&#39;s development is the aging of the population and the increase of the economic level. People&#39;s health suffers from the threat of cardiovascular diseases. Technological health devices can be used to monitor the physiological signals of the human body, which are very informative for the diagnosis and prevention of diseases. The assessment of the physiological signals of the human body can play a role in disease prevention. Therefore the use of portable devices to measure pulse features is significant for the reduction of mortality from cardiovascular diseases.</p><p>Considering that the mobile phone has not only convenience but also excellent expandability, this paper writes a highly available human vital features Mobile Application using JavaScript programming language based on the principle of fiber optic sensing. this Mobile Application can receive the pulse data stream relayed by the server and draw the pulse waveform graph, it can also extract features from the pulse data in real time.</p><p><strong>Keywords</strong>: <em>optical fiber pulse sensor; pulse wave features; BP and PTT; mobile application; JavaScript</em></p><h2 id="第1章-引言" tabindex="-1"><a class="header-anchor" href="#第1章-引言" aria-hidden="true">#</a> 第1章 引言</h2><h3 id="_1-1-前言" tabindex="-1"><a class="header-anchor" href="#_1-1-前言" aria-hidden="true">#</a> 1.1 前言</h3><p>根据世界卫生组织公布的最新数据，2020年全球有1790万人死于心血管疾病，占总死亡人数的31.2%<a href="#reference"><sup>[1]</sup></a>。心血管疾病死亡已成为全球死亡的主要原因<a href="#reference"><sup>[2]</sup></a>。</p><p>根据国家统计局最新公布的数据，我国老龄化问题日益突出。2020年底，我国65岁及以上老年人口占中国总人口的13%。根据报告预测，到2025年我国65岁及以上老年人口比例将达到15%。由于老龄化趋势和工作压力的增加，心血管疾病的风险增加<a href="#reference"><sup>[3]</sup></a>。</p><p>因此，对心血管疾病的预防和控制就显得尤为重要。</p><p>光纤传感器具有无源干扰和抗电磁干扰的优点<a href="#reference"><sup>[4]</sup></a>，可从脉搏所导致的压力变化中生成脉搏信号<a href="#reference"><sup>[5]</sup></a>。因此可利用光纤传感器生成的脉搏信号构建用于监测生命信号的智能系统，在预防和监测心脏病方面具有重要的实际意义<a href="#reference"><sup>[6]</sup></a>。</p><h3 id="_1-2-研究背景及意义" tabindex="-1"><a class="header-anchor" href="#_1-2-研究背景及意义" aria-hidden="true">#</a> 1.2 研究背景及意义</h3><p>21世纪以来，我国经济持续快速增长，人民生活质量随着经济条件的改善而提高。然而，由于饮食结构不合理、生活节奏加快和人口老龄化，严重威胁人类健康的心血管疾病的发病率和死亡率正在上升<a href="#reference"><sup>[7]</sup></a>。心血管疾病是目前威胁人类健康并导致患者致残或死亡的重大疾病<a href="#reference"><sup>[8]</sup></a>。美国国家心血管疾病中心于2015年初公布了调查数据，数据显示城乡居民心血管疾病死亡人数居所有疾病之首。目前，我国心血管病患者占我国总人口的20.7%，其中高血压患者占心血管病患者总数的93.1%。2010年，我国高血压病死亡人数为204.3万人，占每年死亡总人数的24.6%。2013年，我国共投入2107亿元用于高血压的研究和治疗。心血管疾病已成为我国健康问题的头号敌人。据调查，人们对高血压的认识水平仅为42.6%。由于心血管疾病易发生突发性暴发，潜伏期长且不易被发现，实时监测对于保障人们的生命安全非常重要<a href="#reference"><sup>[9]</sup></a>。</p><p>脉搏是表征人体心脏工作和循环系统生理状态的重要信号<a href="#reference"><sup>[10]</sup></a>。在心跳过程中，心房、心室和主动脉之间的压力差导致来自心室的血流进入主动脉并以称为脉搏波的波沿主动脉根部传播。从脉搏波中获得的心脏和循环系统的生理和病理信息可作为临床诊断和治疗的依据<a href="#reference"><sup>[11]</sup></a>。因此脉搏波的研究一直是国内外医学界关注的焦点<a href="#reference"><sup>[12]</sup></a>。现有研究和临床统计表明，反映人体血压、心率、血管弹性、血液粘度等一系列心血管参数可以根据脉搏波形的特征进行区分<a href="#reference"><sup>[13]</sup></a>。</p><p>许多现代智能监控设备使用光电容积传感器技术。这些传感器技术成本低、体积小、系统结构简单，适用于可穿戴设备。但是光电容积传感器有一些限制，例如传感器信号很容易会受外界信号干扰导致数据错误<a href="#reference"><sup>[14]</sup></a>。</p><p><img src="/img/in-post/2022-05-13/1.1.jpg" alt="图1.1 用于健康监测的小米智能手环"></p><blockquote><p>图1.1 用于健康监测的小米智能手环</p></blockquote><p>图1.1 显示了当今市场上用于医疗监测的智能手环。手环正面是显示屏，背面是光电容积脉搏传感器(Photoplethysmography，PPG)，用于捕捉脉搏信号。除日期时间等基本信息外，还显示脉搏、睡眠时间、血压等生理物理信息。不足之处在于光电容积法由于手环佩戴方式会导致脉搏信号特征出现缺失，这将影响最终的预测。此外，采用光电容积法的智能穿戴设备无法对脉搏传播速度(Pulse Wave Transmit Velocity，PWV) 这类关键参数进行监测，而PWV这类参数与动脉硬化密切相关，对动脉硬化和心血管疾病的预防起重要作用<a href="#reference"><sup>[15]</sup></a>。</p><p>基于以上背景，本文以弯曲光纤传感技术为基础结合JavaScript技术，设计了移动APP脉搏监测与实时特征分析系统，用于监测人体桡动脉脉搏波，进行数据可视化展示和关键指标预测，该系统能够较好地还原脉搏波的波形特征，并实现利用脉搏波特征值预测血压和脉搏传播时间(Pulse wave Transmit Time，PTT)。</p><h3 id="_1-3-国内外研究现状" tabindex="-1"><a class="header-anchor" href="#_1-3-国内外研究现状" aria-hidden="true">#</a> 1.3 国内外研究现状</h3><p>1903年，荷兰医生、生理学家Willem Einthoven发明了弦线式检流计，从而带来了心电图历史上的第一次突破<a href="#reference"><sup>[16]</sup></a>。普通的检流计无法检测出被肌肉与骨骼所阻隔的心脏所发出的微弱电流，为了检测心脏的微弱电流，埃因托芬将细导线置于强力磁场中，在磁力的作用下导线会微弱的移动，用光将导线的影子投射到纸上，连续记录下来就可以得到心电图。该装置因电磁铁需要冷却的缘故，重达270公斤，需要5个人进行操作。</p><p>Willem Einthoven把心电图中的一系列波分别命名为P波，Q波，R波，S波和T波，并且描述了一些心血管系统疾病的心电图特点。<a href="#reference"><sup>[17]</sup></a></p><p>1957年位于美国蒙大拿州海伦娜的霍特研究实验室中的实验物理学家Norman Holter和Bill Glasscock研发了动态心电图，他们在1949年开始研究可穿载式的心脏监测设备，并于1962年开始商业生产动态心电图<a href="#reference"><sup>[18]</sup></a>。</p><p>在使用动态心电图来研究心脏时，其作法类似一般标准的心电图测量。动态心电图是透过许多接到胸部的电极来记录心脏的电信号。电极会放在骨头的位置，以减少因为肌肉运动造成的假影。电极的数量和位置依动态心电图的型号而不同，大部分的动态心电图会使用三个至八个不等的电极。</p><p>虽然我们今天仍然在使用那个时代的理论来分析心电图，但是近年来心电描记术领域已经出现了微小的进展。比如，心电记录仪器已经从实验室中的笨重的设备演变成了今天非常便携的装置，并且计算机心电图分析也参与其中。</p><p>2004 年，哈佛传感网络实验室研发了一款集合心电图仪、肌电图仪的综合性无线医疗设备 CodeBlue，该设备的软件具有可拓展性，能够在家庭和医院使用。</p><p><img src="/img/in-post/2022-05-13/1.2.jpg" alt="图1.2 Apple Watch Series 4"></p><blockquote><p>图1.2 Apple Watch Series 4</p></blockquote><p>2018年9月12日，苹果公司发布Apple Watch Series 4其具备电极式心率传感器，可为使用者制作其心电图，供医疗人员参考。</p><p>虽然我国在远程健康监护仪方面研制的时间短，但是由于我国经济的飞速发展以及老龄化程度越来越高，国家和各大高校以及科研单位开始重视此技术的研究，许多科技工作者开始在此领域展开了研究，并取得了一定的成果<a href="#reference"><sup>[19]</sup></a>。而且随着 4G、5G、WI-FI 等通信技术的发展，基于无线网络的远程生理信号监测技术逐渐成为了当前健康监测的主流发展方向<a href="#reference"><sup>[20]</sup></a>。</p><p>2018年哈尔滨理工大学凌建东研究了基于蓝牙与 Andriod 手机通信的生理监护系统，该系统可在手机移动端上将脉搏波绘制并计算出心率与血压<a href="#reference"><sup>[21]</sup></a>。</p><p>同年，东南大学邓猛设计了能在服务器进行数据分析的脉搏信号监测系统<a href="#reference"><sup>[22]</sup></a>。</p><p>2021年6月，赵毅飞设计了基于智能手机的生理参数检测系统<a href="#reference"><sup>[23]</sup></a>。</p><p>综上所述，将脉搏信号测量分析技术与远程传输、移动监控等技术融为一体，可以设计出针对预防心血管疾病和监护人体健康状况的一套低成本移动健康监护系统。</p><h3 id="_1-4-论文研究内容与结构安排" tabindex="-1"><a class="header-anchor" href="#_1-4-论文研究内容与结构安排" aria-hidden="true">#</a> 1.4 论文研究内容与结构安排</h3><p>现有的脉搏波检测系统大多数都依赖于计算机，利用计算机的脉搏波检测系统可以完成较复杂的算法、设计较完善的功能，但由于机体积较大，价格较为昂贵，且不便于携带，限制了仪器的使用范围<a href="#reference"><sup>[24]</sup></a>。本文的研究目的是利用蓝牙、移动互联网技术及智能终端构建一种便携式用于远程医疗诊断的脉搏信号检测与监护系统。</p><p>大多数现有的脉搏波检测系统都依赖于体积较大，不易携带的计算机。本文的目的是开发一种利用云服务器、互联网标准通信协议和移动智能终端的便携式脉搏信号检测和监测系统。</p><p>本文的主要研究内容如下:</p><ol><li>光电脉搏传感器的原理实现</li><li>单片机通过数模转换将脉搏信号数字化并通过ESP8266模块进行转发</li><li>云端服务器接收到信号并进行TCP协议与WebSocket协议的中转</li><li>移动智能终端会对接收到的脉搏波进行相应的处理，用户可查看的脉搏波形图，脉搏波幅值和心率等特征信息，或查看相应的历史数据信息</li></ol><p>本文共分为六章，具体结构如下:</p><p>第1章为绪论部分。本章简要阐述了智能生命体征监测设备发展的必要性，介绍了国内外生命体征监测技术的研究现状。</p><p>第2章为脉搏波测量原理。介绍了脉搏波产生的机理与波形特征，阐述了其各自的成因、重要性和测量方法。描述了脉搏波特征信号的意义，为通过脉搏信号的测量来实现健康状况的监护与心血管疾病的预防提供了依据。最后阐述了基于弯曲光纤传感器的脉搏测量方法。</p><p>第3章为光纤脉搏传感系统的设计。主要设计了一种基于弯曲光纤传感头的小型化脉搏测量系统，包括半导体光源、光纤传感器、光电探测器、MCU系统模块、放大滤波电路、WIFI无线通信模块。介绍了光纤脉搏传感信号采集的设计，完成对脉搏信号的采集任务，并通过网络连接云服务器完成与移动终端 APP 的交互。整个装置具有小体积、低功耗、便于携带的优点。</p><p>第4章为服务器架构，服务与部署。本章将逐一讲述各服务的原理、架构模式、设计原因。服务端整体程序采用云服务技术与容器化技术进行部署，因此本章也将简略介绍云服务技术与容器化技术的设计和优势。</p><p>第5章为软件系统设计。本章详述了智能手机APP的软件设计，介绍了Web开发技术以及采用的关键技术。然后介绍了软件总体架构设计，以及APP的各部分界面设计进行了详细介绍，最后介绍了软件系统中最核心的部分，即对脉搏数据流的处理与特征算法介绍。</p><p>第6章为结论与展望。对之前所做的工作做了一个简短的回顾，并指出了未来进一步的研究方向。</p><h2 id="第2章-脉搏波测量原理" tabindex="-1"><a class="header-anchor" href="#第2章-脉搏波测量原理" aria-hidden="true">#</a> 第2章 脉搏波测量原理</h2><h3 id="_2-1-心电系统和脉搏波的产生原理" tabindex="-1"><a class="header-anchor" href="#_2-1-心电系统和脉搏波的产生原理" aria-hidden="true">#</a> 2.1 心电系统和脉搏波的产生原理</h3><p>心电系统对心脏的功能至关重要，其对心率起决定性作用并协调和组织了心脏肌肉的跳动。心电系统的异常可导致心率过快或过慢，严重甚至会导致心肌和瓣膜的异常。</p><p>心脏会产生自己的电信号（也称为心电脉冲），可以通过在胸部放置电极来记录，这些记录的波形被称为心电图（Electrocardiogram, ECG）。首先每个心电脉冲产生一次心跳，单位时间内的心电脉冲数量决定了心率。当电信号 &quot;扩散 &quot;到整个心脏时，会触发心肌以正确的顺序收缩，从而协调每次心跳，确保心脏尽可能有效地工作。心脏的电信号是由一个位于右心房的上部被称为窦房结的微小结构产生的。</p><p>心电脉冲从窦房结传到右心房和左心房使两个心房收缩，并将其负载的血液推向左右心室。</p><p><img src="/img/in-post/2022-05-13/2.1.jpg" alt="图2.1 心脏电气系统的组成部分"></p><blockquote><p>图2.1 心脏电气系统的组成部分</p></blockquote><p>图2.1 展示了心脏电气系统的组成部分，包括窦房结(SN)和房室结(AV结)。从电学的角度来看，可以认为心脏被分为两部分: 心房(上腔)和心室(下腔)。分隔心房和心室的是一块纤维组织(图中标为房室盘)。这种不导电的组织可以防止心房和心室之间的电信号在房室结之外通过。</p><p>图中结构部分对应:</p><ul><li>SN = 窦房结</li><li>AVN = 房室结</li><li>RA = 右心房</li><li>LA=左心房</li><li>RV = 右心室</li><li>LV=左心室</li><li>TV=三尖瓣(将右心房和右心室分开的瓣膜)</li><li>MV = 二尖瓣(将左心房和左心室分开的瓣膜)</li></ul><h3 id="_2-2-脉搏波特征点的意义" tabindex="-1"><a class="header-anchor" href="#_2-2-脉搏波特征点的意义" aria-hidden="true">#</a> 2.2 脉搏波特征点的意义</h3><p>心脏单次射血入主动脉的过程对应脉冲波的一个周期。每个周期的脉搏波中包含许多特征点，可以反映心血管系统的弹性和外周血管阻力。时间差和幅值就是脉搏波的特征值，一个周期内的主要特征点如图2.2所示:</p><p><img src="/img/in-post/2022-05-13/2.2.jpg" alt="图2.2 单个周期的脉搏波形"></p><blockquote><p>图2.2 单个周期的脉搏波形</p></blockquote><p>各特征点的意义是:</p><ol><li>a点是单个脉搏波周期的起点。是心脏收缩的初始阶段，为动脉内血液的释放做准备。处于周期的最低点。相邻周期中a点之间的时间差为一个脉冲周期。</li><li>b点为主脉搏波的峰值点。为一个周期的最大振幅点。此时心脏收缩程度最大，相应的收缩压也最高。 a-b 段在整个脉搏周期中更陡峭，在此期间心脏继续通过动脉泵血。</li><li>d点是潮波的峰值点。此时心输出量的强度减慢，心脏收缩到最小的体积。然后血压逐渐下降。潮波通常出现在主波波峰之后，其幅度略低于主波峰的幅度。</li><li>e点是重博波谷点，标志着心脏射血完成，射血过程放缓，代表主动脉瓣逐渐关闭的过程。</li><li>f点是重博波峰点，代表心脏开始舒张，血液回流，动脉再次膨胀。</li></ol><p>心脏向动脉射血，血液在动脉中以脉搏波的形式继续传播，因而脉搏波除了受心脏的影响之外，还受到主动脉和各级分支动脉的影响，这也导致了不同个体的脉搏波具有不同的波形特征<a href="#reference"><sup>[25]</sup></a>。</p><h3 id="_2-3-ecg和ppg心电信号图" tabindex="-1"><a class="header-anchor" href="#_2-3-ecg和ppg心电信号图" aria-hidden="true">#</a> 2.3 ECG和PPG心电信号图</h3><p>现有的对心脏监测的方法有两种，即ECG与光电容积脉搏波描记法（PPG）。</p><p>ECG是通过在心脏附近的胸部放置电极进行收集，这些电极测量每个心动周期中心脏的电激活情况。ECG的优点是直接测量心脏的心电信号，干扰较少，信号准确。主要的缺点是测量ECG的胸部电极不适合用于便携移动的持久化测量中。</p><p>PPG采用一个光学传感器来测量每次心跳时血液在动脉和毛细血管中灌注时皮肤颜色的变化，通常使用指尖或手腕上的便携装置进行测量。PPG 方法的优点是成本低、可携带、轻量化。然而与心电图测量相比，PPG 更易受环境影响，相比ECG往往包含更多噪音，使得分析更加困难。</p><h3 id="_2-4-基于弯曲光纤传感器的脉搏测量方法" tabindex="-1"><a class="header-anchor" href="#_2-4-基于弯曲光纤传感器的脉搏测量方法" aria-hidden="true">#</a> 2.4 基于弯曲光纤传感器的脉搏测量方法</h3><p>近年来，利用弯曲光纤传感器监测人体生理信号受到了广泛关注。弯曲的光纤压力传感器具有灵敏、解调简单的优点，可以成功地还原脉搏波的特性。因此，本文中采用了基于弯曲光纤传感器头获取桡动脉处的脉搏波。</p><p><img src="/img/in-post/2022-05-13/2.3.jpg" alt="图2.3 弯曲光纤示意图"></p><blockquote><p>图2.3 弯曲光纤示意图</p></blockquote><p>弯曲光纤传感器头是通过将单模光纤弯曲一定角度制成的<a href="#reference"><sup>[26]</sup></a>。传感器是基于光纤宏弯损耗的原理。当光纤弯曲到一定角度时，光信号继续沿着光纤的纤芯传播，其余的则沿着光纤的纤芯传播。光通过纤芯渗入弯曲外壳，降低了另一端的输出光输出功率。也称为弯曲光纤损耗。光纤的曲率半径远大于纤芯直径，因此传输以宏弯损耗为主。</p><p>根据光弯曲损耗原理制成的传感器属于强度调制光纤传感器。即外部信号的变化直接调制光强。随着外部信号的变化，光的强度也会发生变化。因此只需要检查输出光的强度变化，即可据实现外部信号的测量。</p><h3 id="_2-5-本章小结" tabindex="-1"><a class="header-anchor" href="#_2-5-本章小结" aria-hidden="true">#</a> 2.5 本章小结</h3><p>作为理论基础的阐述，本章介绍了心电系统的作用机理，以及脉搏波生理特征参数的意义。接着介绍了基于弯曲光纤技术的脉搏波测量方法。</p><h2 id="第3章-光纤脉搏传感系统" tabindex="-1"><a class="header-anchor" href="#第3章-光纤脉搏传感系统" aria-hidden="true">#</a> 第3章 光纤脉搏传感系统</h2><h3 id="_3-1-光纤脉搏传感系统简介" tabindex="-1"><a class="header-anchor" href="#_3-1-光纤脉搏传感系统简介" aria-hidden="true">#</a> 3.1 光纤脉搏传感系统简介</h3><p>本章将详细讲述光纤脉搏传感系统的构成，以及各模块如何组成整体相互协作，以及各自模块所发挥的作用。</p><p><img src="/img/in-post/2022-05-13/3.1.jpg" alt="图3.1 光纤传感系统架构图"></p><blockquote><p>图3.1 光纤传感系统架构图</p></blockquote><p>图3.1为光纤传感系统为本文采用光纤传感系统架构图，光纤传感系统主要由信号采集系统和信号处理系统组成。</p><p>信号采集系统包括: 半导体光源、光纤传感头、光电探测器。</p><p>信号处理系统包括: MCU系统模块、放大滤波电路、WIFI无线通信模块。</p><h3 id="_3-2-信号采集系统" tabindex="-1"><a class="header-anchor" href="#_3-2-信号采集系统" aria-hidden="true">#</a> 3.2 信号采集系统</h3><p>信号采集系统由半导体光源、光纤传感头、光电探测器，本章将重点介绍光纤脉搏传感信号采集系统的构成，器件选取与系统搭建。</p><h4 id="_3-2-1-半导体光源" tabindex="-1"><a class="header-anchor" href="#_3-2-1-半导体光源" aria-hidden="true">#</a> 3.2.1 半导体光源</h4><p>光源是传感器的信号生成部分。由于本系统的目标使用场景要求小型化、便携化，故此本系统选用的光源为上海嘉慧光电子技术有限公司生产的单模同轴激光二极管光源 (1550nm DFB SM coaxial laser diode)。</p><p>该光源有如下优点:</p><ol><li>信号稳定。该型号光源输出光信号稳定，产生的波长为 1550nm 的光信号信噪比高。</li><li>功耗低。该光源功耗较低，工作电压为1.2V。供电简单，仅需一粒1.2v纽扣电池即可正常工作。</li><li>体积小。该光源相对于其他光源，驱动电路简单小巧，适用于微型化系统。</li></ol><p><img src="/img/in-post/2022-05-13/3.2.jpg" alt="图3.2 激光二极管光源"></p><blockquote><p>图3.2 激光二极管光源</p></blockquote><h4 id="_3-2-2-弯曲光纤传感头" tabindex="-1"><a class="header-anchor" href="#_3-2-2-弯曲光纤传感头" aria-hidden="true">#</a> 3.2.2 弯曲光纤传感头</h4><p>本文使用的弯曲光纤传感头采用普通单模裸光纤制成。根据第2章介绍的弯曲损耗原理可知，弯曲半径越小，灵敏度越大，损耗越大。考虑到其灵敏度和损耗对实验的影响，本文制作的弯曲光纤传感头的弯曲半径为3mm。为了保证传感头的能够在日常生活中长期使用，本文针对传感头进行了如下包装设计:</p><ol><li>使用内置弯曲光纤传感头的魔术带作为固定带。</li><li>采用触感和柔软度接近人体皮肤的硅胶作为接触面。</li><li>选择一条细布条作为魔术带和硅胶之间的连接，缠绕在硅胶周围并用胶水固定。</li><li>将单模光纤弯曲到3mm的弯曲半径并粘在一块薄布上，使用UV胶固定硬化。</li></ol><p>封装的触摸头显著提高了其使用寿命并提高了测量效果，并且具有小型化和便携化的优点。其结构示意图如图3.3所示。</p><p><img src="/img/in-post/2022-05-13/3.3.jpg" alt="图3.3 弯曲光纤传感头"></p><blockquote><p>图3.3 弯曲光纤传感头</p></blockquote><h4 id="_3-2-3-光电探测器" tabindex="-1"><a class="header-anchor" href="#_3-2-3-光电探测器" aria-hidden="true">#</a> 3.2.3 光电探测器</h4><p>光电探测器的主要功能是将光信号转换为电信号。市场上的探测器种类繁多，其性能对信噪比有直接影响。本文选用InGaAs PIN 光电二极管，该型号器件具有如下优点:</p><ol><li>灵敏度高，仅为 1mV/mW</li><li>暗电流小，外接供电电压小</li><li>适用于小型化的系统，工作部分尺寸为 1 mm。</li></ol><p><img src="/img/in-post/2022-05-13/3.4.jpg" alt="图3.4 FC 接口型 InGaAs PIN 光电二极管"></p><blockquote><p>图3.4 FC 接口型 InGaAs PIN 光电二极管</p></blockquote><h3 id="_3-3-信号处理系统" tabindex="-1"><a class="header-anchor" href="#_3-3-信号处理系统" aria-hidden="true">#</a> 3.3 信号处理系统</h3><p>MCU系统是整个脉搏传感系统的中心，其主要功能是接收光纤脉搏传感器的信号并控制其运行状态，并将处理后的信号通过TCP协议传输到云服务器。</p><p>本系统对脉搏信号的测定有便携性，轻量化和实时性的要求，因此对控制器有以下要求:</p><ol><li>具有高分辨率的ADC功能，可以准确地接收和转换弯曲光纤传感器检测到的信号。</li><li>适配丰富的通讯接口，必须支持TCP网络传输，可以支持蓝牙通讯扩展。</li><li>具有数字信号处理和浮点运算功能，可对采集到的脉冲信号进行处理和分析。</li><li>体积小，芯片尺寸不宜过大，可作为可穿戴设备的处理中心。</li><li>低功耗，可随身携带可穿戴设备进行长期监测。</li></ol><p>最终本文采用了STM32F103C8T6作为处理器，这是一款32位ARM Cortex-M STM32系列内核微控制器，该芯片为48针外壳，内置定时器等资源，内置12位ADC。具有低成本、高性能、低功耗、高集成度等诸多优点。使用该芯片作为脉搏传感器整个节点的控制芯片，不仅可以利用其卓越的性能满足功能需求。因其内置了ADC芯片，系统不需要使用额外的ADC芯片，满足了采集单元小尺寸和低功耗的要求。</p><h3 id="_3-4-本章小节" tabindex="-1"><a class="header-anchor" href="#_3-4-本章小节" aria-hidden="true">#</a> 3.4 本章小节</h3><p>本章介绍了光纤脉搏传感系统的两大主要组成部分: 信号采集系统和信号处理系统。本章详细介绍了信号采集系统的各个组成部分，包括半导体光源、弯曲光纤传感头、光电探测器，并简略介绍各部分工作原理。并大致介绍了信号处理系统及其核心部分MCU系统。</p><h2 id="第4章-服务器架构-服务与部署" tabindex="-1"><a class="header-anchor" href="#第4章-服务器架构-服务与部署" aria-hidden="true">#</a> 第4章 服务器架构，服务与部署</h2><blockquote><p>服务器端代码 - <a href="https://github.com/louisyoungx/tcp-transfer-server" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/tcp-transfer-server</a></p></blockquote><h3 id="_4-1-服务器架构概述" tabindex="-1"><a class="header-anchor" href="#_4-1-服务器架构概述" aria-hidden="true">#</a> 4.1 服务器架构概述</h3><p>脉搏传感系统和客户端之间通过服务器进行连接，这相比目前主流的蓝牙连接有几个非常显著的优点:</p><ul><li>连接方便快捷。传统蓝牙连接方式每次打开客户端都要与传感器进行蓝牙配对和连接，而通过服务器中转架构只需打开手机即可查看脉搏波形。</li><li>云端数据保存。无需担心用户不小心清空软件数据。</li><li>借用云端算力进行云计算数据分析。移动端算力并不足以运行基于机器学习和深度学习的脉搏波病理分析的模型。</li><li>成本低廉。由于云服务的普及推广，上云不仅方便稳定，还具有带宽大且价格低廉的优点。</li></ul><p>本文所设计的服务端程序的基于Turbon基础架构与基于B/S模式(浏览器服务器模式)进行设计，以 VSCode 为软件开发平台，采用Python作为开发语言，Nginx作为Web服务器。借助Turbon框架的store模块对用户数据进行储存。在设计模式上，采用了宏服务模式。主要服务包括API服务、协议转换与转发服务。本章将会逐一讲述各服务的原理、架构模式、设计原因。服务端整体程序采用云服务技术与容器化技术进行部署，因此本章也将简略介绍云服务技术与容器化技术的设计和优势。</p><h3 id="_4-2-基础架构" tabindex="-1"><a class="header-anchor" href="#_4-2-基础架构" aria-hidden="true">#</a> 4.2 基础架构</h3><p>Turbon是本文作者自研的All in One Python项目运行基础框架，无需安装任何第三方库， 内置纯Python原生实现的多进程http服务器，可通过内置restful web api或网页查看本地日志，可自定义web模版, 可定时执行代码，可动态加载依赖包，可进行消息通知，可定义服务器api查看运行状态，可进行持久化存储，有完善的日志与配置系统。</p><p>Turbon框架的组织方式秉持模块化的思想，各模块之间高内聚，低耦合。</p><p>各模块功能列表:</p><ul><li><code>Config</code><ul><li><code>config.yaml</code> - 配置信息</li><li><code>config</code> - 对config.ini中数据进行读取与初始化</li><li><code>direct</code> - 字典转对象，通过点直接访问配置属性</li></ul></li><li><code>Core</code><ul><li><code>core</code> - 程序执行的入口</li></ul></li><li><code>Depend</code><ul><li><code>load_depend</code> - 导入依赖</li><li><code>import_lib</code> - 动态加载依赖</li></ul></li><li><code>Logger</code><ul><li><code>Log_Files</code> - 存储日志文件</li><li><code>logger</code> - 日志模块</li><li><code>progress</code> - 进度条模块</li></ul></li><li><code>Message</code><ul><li><code>message</code> - 消息传递接口，可通过QQ机器人与邮箱发送信息</li></ul></li><li><code>Scheduler</code><ul><li><code>scheduler</code> - 批量执行任务模块</li><li><code>task</code> - 单任务定时执行模块</li></ul></li><li><code>Server</code><ul><li><code>api</code> - 自定义api</li><li><code>handler</code> - 包含主要的HTTP请求处理</li><li><code>router</code> - api路由函数</li><li><code>server</code> - 用于配置并启动服务器线程</li><li><code>url</code> - 用于路由配置</li></ul></li><li><code>Static</code><ul><li>静态文件存放目录</li></ul></li><li><code>Storage</code><ul><li><code>storage</code> - 数据持久化存储</li><li><code>reactive</code> - 实现数据响应式</li></ul></li><li><code>TEST</code><ul><li>一些测试文件</li></ul></li><li><code>runserver</code><ul><li><code>Turbon</code>启动入口</li></ul></li></ul><p>可通过配置文件对各模块进行功能开关和对应控制。</p><div class="language-yaml ext-yml"><pre class="language-yaml"><code><span class="token key atrule">Information</span><span class="token punctuation">:</span>
  <span class="token key atrule">project</span><span class="token punctuation">:</span> Turbon
  <span class="token key atrule">version</span><span class="token punctuation">:</span> 1.0.0<span class="token punctuation">-</span>beta
  <span class="token key atrule">author</span><span class="token punctuation">:</span> Louis·Young
  <span class="token key atrule">time</span><span class="token punctuation">:</span> <span class="token datetime number">2021-07-27</span>

<span class="token key atrule">Debug</span><span class="token punctuation">:</span> <span class="token comment"># 调试设置(用于测试Core中代码)</span>
  <span class="token key atrule">open</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 开启Debug后无视Scheduler只会执行Core.core.main函数中代码</span>

<span class="token key atrule">Server</span><span class="token punctuation">:</span> <span class="token comment"># 服务器设置(用于提供静态文件和api)</span>
  <span class="token key atrule">open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 是否启用服务器</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Turbon<span class="token punctuation">-</span>Server <span class="token comment"># 服务器名</span>
  <span class="token key atrule">version</span><span class="token punctuation">:</span> 1.0.0<span class="token punctuation">-</span>beta <span class="token comment"># 服务器版本</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">12000</span> <span class="token comment"># 运行端口号</span>
  <span class="token key atrule">local_host</span><span class="token punctuation">:</span> 0.0.0.0 <span class="token comment"># 用于启动项目的局域网IP</span>
  <span class="token key atrule">server_host</span><span class="token punctuation">:</span> localhost <span class="token comment"># 填写服务器域名</span>
  <span class="token key atrule">process_mode</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否开启多进程</span>
  <span class="token key atrule">process_count</span><span class="token punctuation">:</span> <span class="token number">4</span> <span class="token comment"># 进程数量</span>
  <span class="token key atrule">static_path</span><span class="token punctuation">:</span> /Static

<span class="token key atrule">Logger</span><span class="token punctuation">:</span> <span class="token comment"># 日志设置(用于日志系统)</span>
  <span class="token key atrule">file_name</span><span class="token punctuation">:</span> turbon.log <span class="token comment"># 日志文件名</span>
  <span class="token key atrule">file_path</span><span class="token punctuation">:</span> /Logger/Log_Files/ <span class="token comment"># 日志文件地址</span>
  <span class="token key atrule">count</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token comment"># 日志文件个数</span>
  <span class="token key atrule">max_bytes</span><span class="token punctuation">:</span> <span class="token number">10485760</span> <span class="token comment"># 单个日志文件的大小</span>
  <span class="token key atrule">clear_up</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 每次启动程序是否清理日志文件中内容</span>
  <span class="token key atrule">colorful</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>  <span class="token comment"># 命令行色彩输出</span>
  <span class="token key atrule">server_logger</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 开启 Server 的详细日志记录</span>

<span class="token key atrule">Storage</span><span class="token punctuation">:</span> <span class="token comment"># 本地存储设置(用于状态持久化存储)</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> state.json <span class="token comment"># 存储文件名</span>
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /Storage/ <span class="token comment"># 存储地址</span>

<span class="token key atrule">Depend</span><span class="token punctuation">:</span> <span class="token comment"># 依赖管理模块(用于动态引入依赖库)</span>
  <span class="token key atrule">open</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">file</span><span class="token punctuation">:</span> requirements.txt
  <span class="token key atrule">path</span><span class="token punctuation">:</span> /

<span class="token key atrule">Scheduler</span><span class="token punctuation">:</span> <span class="token comment"># 调度器设置(用于定时执行)</span>
  <span class="token key atrule">open</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否开启定时执行</span>
  <span class="token key atrule">skip_weekend</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># 周末不执行任务</span>
  <span class="token key atrule">time</span><span class="token punctuation">:</span> <span class="token comment"># 任务执行时间</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;18:00:00&quot;</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;19:00:00&quot;</span>
    <span class="token punctuation">-</span> <span class="token string">&quot;20:00:00&quot;</span>

<span class="token key atrule">Message</span><span class="token punctuation">:</span> <span class="token comment"># 消息发送设置(用于通知)</span>
  <span class="token key atrule">open</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment"># 是否开启消息通知，开启后会自动发送到设置好的Mirai QQ消息服务器</span>
  <span class="token key atrule">target_server</span><span class="token punctuation">:</span> ip.address<span class="token punctuation">:</span>port <span class="token comment"># 通知服务器，当前使用Mirai服务</span>
</code></pre></div><p>所有采用Turbon框架开发的程序都会通过一个单一Python程序的形式呈现。</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">import</span> Depend
<span class="token keyword">from</span> concurrent<span class="token punctuation">.</span>futures <span class="token keyword">import</span> ProcessPoolExecutor
<span class="token keyword">from</span> Core <span class="token keyword">import</span> core
<span class="token keyword">from</span> Logger <span class="token keyword">import</span> logger
<span class="token keyword">from</span> Scheduler <span class="token keyword">import</span> Scheduler
<span class="token keyword">from</span> Config <span class="token keyword">import</span> config
<span class="token keyword">from</span> Server <span class="token keyword">import</span> server
<span class="token keyword">from</span> threading <span class="token keyword">import</span> Thread


<span class="token keyword">def</span> <span class="token function">running</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    PROCESS_MODE <span class="token operator">=</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>process_mode
    SCHEDULER <span class="token operator">=</span> config<span class="token punctuation">.</span>Scheduler<span class="token punctuation">.</span><span class="token builtin">open</span>
    SERVER <span class="token operator">=</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span><span class="token builtin">open</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> SCHEDULER<span class="token punctuation">:</span>
        thread_core <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>core<span class="token punctuation">)</span>
        thread_core<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># 调度器开启后core函数将被scheduler调度器代理，开启定时执行core</span>
        startTime <span class="token operator">=</span> config<span class="token punctuation">.</span>Scheduler<span class="token punctuation">.</span>time
        skipWeekend <span class="token operator">=</span> config<span class="token punctuation">.</span>Scheduler<span class="token punctuation">.</span>skip_weekend
        scheduler <span class="token operator">=</span> Scheduler<span class="token punctuation">(</span>task<span class="token operator">=</span>core<span class="token punctuation">,</span> startTime<span class="token operator">=</span>startTime<span class="token punctuation">,</span> skipWeekend<span class="token operator">=</span>skipWeekend<span class="token punctuation">)</span>
    <span class="token keyword">if</span> SERVER<span class="token punctuation">:</span>
        <span class="token keyword">if</span> PROCESS_MODE<span class="token punctuation">:</span>
            work_count <span class="token operator">=</span> config<span class="token punctuation">.</span>Server<span class="token punctuation">.</span>process_count
            server_process<span class="token punctuation">(</span>work_count<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            thread_server <span class="token operator">=</span> Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>server<span class="token punctuation">)</span>
            thread_server<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">server_process</span><span class="token punctuation">(</span>work_count<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> ProcessPoolExecutor<span class="token punctuation">(</span>work_count<span class="token punctuation">)</span> <span class="token keyword">as</span> pool<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>work_count<span class="token punctuation">)</span><span class="token punctuation">:</span>
            pool<span class="token punctuation">.</span>submit<span class="token punctuation">(</span>server<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&quot;__main__&quot;</span><span class="token punctuation">:</span>
    DEBUG <span class="token operator">=</span> config<span class="token punctuation">.</span>Debug<span class="token punctuation">.</span><span class="token builtin">open</span>
    <span class="token keyword">if</span> DEBUG<span class="token punctuation">:</span>
        logger<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">&quot;\n===== DEBUG MODE =====&quot;</span><span class="token punctuation">)</span>
        core<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        running<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Turbon框架的稳定性经过大型项目的考验，是值得信赖的。</p><blockquote><p>Turbon框架代码 - <a href="https://github.com/louisyoungx/turbon" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/turbon</a></p></blockquote><h3 id="_4-3-api服务" tabindex="-1"><a class="header-anchor" href="#_4-3-api服务" aria-hidden="true">#</a> 4.3 API服务</h3><p>本服务端的API服务采用RESTful API的通信模式，服务端API服务主要包括登录鉴权API与数据通信API，由Turbon框架的Server模块提供支持。</p><p>API是一套用于构建和整合应用软件的定义和协议，也被称为信息提供者和信息使用者之间的协议。API确定调用端需要获取的信息和响应端需要回应的内容。例如，本服务端的API服务设计可以由客户端提供一个用户的ID，并由服务端回复一个包括历史脉搏数据的列表。</p><p>API也看作是用户与他们想要获得的服务器资源或服务之间的联系人，即一个组织分享资源和信息的方式。API同时也需要确保用户访问和内容传输的安全性，所以也要承担决定谁可以访问什么服务或资源的权限，即需要具备控制和认证的功能。例如，本服务端在获取用户数据和建立通信之前需要用户先进行登录操作，这需要由客户端通过API服务向服务器请求权限，如果认证通过，服务器又会通过API返回一个对应该用户的Cookie作为凭证，如果认证不通过，服务器会返回一个拒绝信息。</p><p>REST是REpresentational State Transfer的首字母缩略词，代表表示状态转移，由计算机科学家Roy Fielding创建。RESTful API即符合REST架构风格约束的应用编程接口，是一种分布式超媒体系统的架构风格。RESTful使程序的API通信更快、更轻，可扩展性更强，非常适合物联网和移动应用开发<a href="#reference"><sup>[27]</sup></a>。</p><p>在本文项目中，所有服务器和客户端之间的通信都是通过REST风格的API进行传输通信的，即通过RESTful API进行通信。因此本文中开发的API符合这些标准:</p><ul><li>客户与服务器分离，通过HTTP协议进行通信求。</li><li>客户与服务器之间的通信无状态，每个请求都是没有联系的独立请求。</li><li>数据可缓存，精简客户端与服务器之间不必要的互动。</li><li>组件之间的统一接口，信息以标准形式传输。</li><li>所请求资源可识别。即客户端可以通过收到的描述对资源进行操作，这要求响应中表示包含足够的信息，即资源的可识别性。</li></ul><h3 id="_4-4-协议转换与转发服务" tabindex="-1"><a class="header-anchor" href="#_4-4-协议转换与转发服务" aria-hidden="true">#</a> 4.4 协议转换与转发服务</h3><p>光纤脉搏传感器与移动APP客户端无法直接进行通信，需要服务器进行数据中转，即通过服务器传递脉搏传感器与移动APP客户端之间的数据。并且由于光纤脉搏传感器与移动APP客户端的通信协议不同，故此需要服务器进行协议转换才能进行对应连接。</p><p>在协议转换与转发服务中，光纤脉搏传感器与移动APP客户端被抽象为两个对象，详见下表:</p><table><thead><tr><th>概念</th><th>实际对应</th><th>通信协议</th></tr></thead><tbody><tr><td>Sender</td><td>光纤脉搏传感器</td><td>TCP</td></tr><tr><td>Receiver</td><td>移动APP客户端</td><td>WebSockect</td></tr></tbody></table><p>Sender与服务器通过 TCP 通信协议进行数据传输，当完成三次握手协议后数据能正常在两者之间进行传输。而Receiver与服务器之间是通过 WebSocket 通信协议进行数据传输，完成 WebSocket 握手后，数据通过服务器进行协议转换并将在两者之间正常传输。</p><h4 id="_4-4-1-tcp协议" tabindex="-1"><a class="header-anchor" href="#_4-4-1-tcp协议" aria-hidden="true">#</a> 4.4.1 TCP协议</h4><p>在光纤脉搏传感器的可选网络协议中，可选协议有TCP和UDP。本节将对TCP与UDP协议进行对比，说明本文挑选TCP作为光纤脉搏传感器与服务器之间的传输协议是出于哪些考量，并详细描述TCP协议连接传输的过程原理。</p><p>TCP协议<a href="#reference"><sup>[28]</sup></a>(传输控制协议)是面向连接的，一旦建立了连接，数据就可以双向传输。TCP有内建的错误检查系统可以检查出出错的数据包，并且可以保证数据将按照发送的顺序传递，这使得TCP成为传输静止图像、数据文件和网页等信息的完美协议。但尽管TCP非常地可靠，更繁琐的反馈机制也导致了更大的开销，对网络传输的可用带宽作出了限制。</p><p>UDP协议(用户数据报协议)是一种更简单、无连接的互联网协议，不需要数据包错误检查和丢包重新传输。使用UDP协议无需付出建立连接、维持连接或终止连接的开销，数据被持续地发送给接受端，但并不确保数据是否被接受端是否收到，也不确保接收端收到的数据包顺序的正确与否。UDP的特性不适用于发送电子邮件、查看网页或下载文件，但对于网络直播，大流量视频或并行网络传输等实时通信来说是当仁不让的首选。</p><p>下表对TCP与UDP各自特点做了对比:</p><table><thead><tr><th>特点</th><th>TCP</th><th>UDP</th></tr></thead><tbody><tr><td>连接状态</td><td>面向连接，需要已建立的连接来传输数据，传输完成后应关闭连接</td><td>无连接，无需打开、维护或终止连接</td></tr><tr><td>数据排序</td><td>确保数据包排序正确</td><td>数据包可能是乱序的</td></tr><tr><td>确保数据包到达</td><td>可以保证将数据包全部传输到目的地</td><td>无法保证数据全部到达</td></tr><tr><td>数据的重新传输</td><td>重新传输丢失的数据包</td><td>没有丢包重传</td></tr><tr><td>错误检查</td><td>完善的错误检查和数据确认</td><td>使用校验和的基本错误检查机制</td></tr><tr><td>速度</td><td>比UDP慢</td><td>比TCP快</td></tr><tr><td>使用场景</td><td>HTTP、SMTP、POP、FTP等协议中广泛使用</td><td>视频会议、网络视频、DNS、VoIP等</td></tr></tbody></table><p>由于在本项目中，即脉搏信号的传输中，对数据包的顺序，数据的正确性和数据包的完整性都有要求，否则可能造成脉搏波形紊乱，特征错误和数据预测出现严重错误结果，因此不可靠的UDP传输不能用于脉搏信号的传输。</p><p>TCP协议的运行可划分为三个阶段: 连接创建(connection establishment)、数据传送(data transfer)和连接终止(connection termination)。</p><p>TCP用三次握手(three-way handshake)过程创建一个连接。通常由服务器端打开一个套接字(socket)监听来自客户端的连接，即被动打开(passive open)。服务器端被打开，客户端就能开始创建主动打开(active open)。</p><p>服务器端执行了listen函数后，就在服务器上创建起两个队列:</p><ul><li>SYN队列: 存放完成了二次握手的结果。 队列长度由listen函数的参数backlog指定。</li><li>ACCEPT队列: 存放完成了三次握手的结果。队列长度由listen函数的参数backlog指定。</li></ul><p>三次握手协议的过程:</p><ol><li>客户端(通过执行connect函数)向服务器端发送一个SYN包，请求一个主动打开。该包携带客户端为这个连接请求而设定的随机数A作为消息序列号。</li><li>服务器端收到一个合法的SYN包后，把该包放入SYN队列中；回送一个SYN/ACK。ACK的确认码应为A+1，SYN/ACK包本身携带一个随机产生的序号B。</li><li>客户端收到SYN/ACK包后，发送一个ACK包，该包的序号被设定为A+1，而ACK的确认码则为B+1。然后客户端的connect函数成功返回。当服务器端收到这个ACK包的时候，把请求帧从SYN队列中移出，放至ACCEPT队列中；这时accept函数如果处于阻塞状态，可以被唤醒，从ACCEPT队列中取出ACK包，重新创建一个新的用于双向通信的sockfd，并返回。</li></ol><p><img src="/img/in-post/2022-05-13/4.1.jpg" alt="图4.1 TCP连接创建"></p><blockquote><p>图4.1 TCP连接创建</p></blockquote><p>在TCP的数据传送状态，很多重要的机制保证了TCP的可靠性和强壮性: 使用序号，对收到的TCP报文段进行排序以及检测重复的数据；使用校验和检测报文段的错误，即无错传输；使用确认和计时器来检测和纠正丢包或延时；流控制(Flow control)；拥塞控制(Congestion control)；丢失包的重传。</p><p><img src="/img/in-post/2022-05-13/4.2.jpg" alt="图4.2 TCP数据包结构"></p><blockquote><p>图4.2 TCP数据包结构</p></blockquote><p>服务端Sender核心代码:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">handleSend</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>  <span class="token comment"># recieving valid messages from client</span>
            message <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
            broadcast<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;====== Send Close ======&quot;</span><span class="token punctuation">)</span>
            broadcast<span class="token punctuation">(</span><span class="token string">&#39;Send Closed&#39;</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre></div><h4 id="_4-4-2-websocket协议" tabindex="-1"><a class="header-anchor" href="#_4-4-2-websocket协议" aria-hidden="true">#</a> 4.4.2 WebSocket协议</h4><p>在移动APP客户端与服务器的网络连接中，可选通信方式有最前沿的WebSocket技术和主流的HTTP轮询请求技术。本节将对WebSocket与HTTP轮询请求进行对比，说明本文挑选WebSocket作为移动APP客户端与服务器的网络连接中的通信方式是出于哪些考量，并详细描述WebSocket协议连接传输的过程原理。</p><p>HTTP轮询本质上是原始轮询技术，即向服务器发出重复请求，这会造成会严重的资源浪费，因为每个新HTTP连接都要重新建立，HTTP查询头需要被重新解析，并且必须对新数据进行重新查询，服务器还需要重新生成和交付一个一般不包含新数据响应。然后需要花时间关闭连接并清理连接资源。</p><p><img src="/img/in-post/2022-05-13/4.3.jpg" alt="图4.3 HTTP轮询请求"></p><blockquote><p>图4.3 HTTP轮询请求</p></blockquote><p>WebSocket<a href="#reference"><sup>[29]</sup></a>是建立在设备的TCP/IP协议栈之上的一个新的传输层。其目的是为网络应用程序开发者提供一个本质上近似于原始的TCP通信层，同时也新增一些措施来消除网络传输的一些弊端。并且基于WebSocket的网络传输非常安全，带有有额外的安全加密。</p><p><img src="/img/in-post/2022-05-13/4.4.jpg" alt="图4.4 WebSocket连接"></p><blockquote><p>图4.4 WebSocket连接</p></blockquote><p>总体来说，WebSocket是移动APP客户端与服务器的网络通信中更好的选择。长时间的HTTP轮询对服务器的资源消耗更大，而WebSocket对服务器的占用极轻。</p><p>建立Websocket连接需要通过浏览器发出请求，之后服务器进行回应，这个过程通常称为握手(Handshaking)。握手以HTTP请求开始，约定进行协议升级，并在HTTP连接所在端口建立WebSocket连接。一旦建立了连接，通信就切换到不符合HTTP协议的双向二进制协议。连接建立后，客户端和服务器可以在全双工模式下来回发送WebSocket数据或文本帧。WebSocket的传输被描述为消息，其中一条消息可以选择分割成几个数据帧。通过对协议的扩展，也可以用于同时复用几个数据流。</p><p>WebSocket的优点有:</p><ul><li>全双工异步消息传递。客户端和服务器都可以独立且主动地将信息流传给对方。</li><li>兼容性好。WebSocket可通过大多数防火墙而不需要重新配置。</li><li>安全性高。基于来源的加密安全模型。</li></ul><p>服务端Receiver核心代码:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">handleReceive</span><span class="token punctuation">(</span>Receiver<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>  <span class="token comment"># recieving valid messages from client</span>
            message <span class="token operator">=</span> Receiver<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
            broadcast<span class="token punctuation">(</span>message<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>  <span class="token comment"># removing receivers</span>
            receivers<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>Receiver<span class="token punctuation">)</span>
            Receiver<span class="token punctuation">.</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;====== Receive Close ======&quot;</span><span class="token punctuation">)</span>
            broadcast<span class="token punctuation">(</span><span class="token string">&#39;Receive Closed&#39;</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre></div><h4 id="_4-4-3-并发连接与转发" tabindex="-1"><a class="header-anchor" href="#_4-4-3-并发连接与转发" aria-hidden="true">#</a> 4.4.3 并发连接与转发</h4><p>协议转换与转发服务的并发连接模型有两种选择，即多线程模型和多进程模型。本节将会讲述多线程模型和多进程模型的概念和区别，以及本文项目选用多线程模型进行连接服务的原因。</p><p>多进程是指一个系统能够并发地运行多个处理器，每个处理器可以运行一个或多个进程。多进程使单个处理器复制全部代码、数据和文件，开销比多线程更大。多进程对CPU多核心计算很有优势，比如计算量大的任务。</p><p><img src="/img/in-post/2022-05-13/4.5.jpg" alt="图4.5 多进程模型"></p><blockquote><p>图4.5 多进程模型</p></blockquote><p>多线程是指一个处理器并发执行多个线程的能力，每个线程运行一个程序。在多线程中，每个线程共享相同的代码、数据和文件，只是在不同的寄存器和堆栈上运行，也因此多线程对I/O操作有很大优势，比如从文件系统，网络或数据库中读取数据。</p><p><img src="/img/in-post/2022-05-13/4.6.jpg" alt="图4.6 多线程模型"></p><blockquote><p>图4.6 多线程模型</p></blockquote><p>协议转换与转发服务的特点是一个I/O操作特别大的服务，但并非一个计算量很大的计算密集型服务，因此综上原因采取多线程模型，每个Sender和Receiver的连接都会建立一个新的线程，以免阻塞主线程。并且多线程模型还给协议转换与转发服务带来一个优点是，每个线程可以共享数据段数据，即可以共用一个全局变量来作为消息队列，这避免了多进程中I/O锁的问题，大大简化了代码工作量。</p><h4 id="_4-4-4-服务器转发运行流程" tabindex="-1"><a class="header-anchor" href="#_4-4-4-服务器转发运行流程" aria-hidden="true">#</a> 4.4.4 服务器转发运行流程</h4><ol><li>光纤传感系统通过TCP协议连接上服务器进行数据传输，服务器启动一个Sender线程，准备接受数据。</li><li>APP客户端通过HTTP协议连接服务器，并与服务器协商升级为WebSocket协议进行数据接收，服务器启动一个Receiver线程，准备发送数据。</li><li>服务器将所有从Receiver接受到的数据加入一个缓存列表中。</li><li>服务器将缓存中的数据发送到APP客户端。</li></ol><p>转发服务主程序:</p><div class="language-python ext-py"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 接受多个receiver作为数据源</span>
    allow <span class="token operator">=</span> <span class="token string">&#39;&#39;</span> <span class="token comment"># 允许的ip地址</span>
    <span class="token keyword">global</span> receivers
    receivers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token comment"># socket对象实例化</span>
    server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>allow<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># 在socket对象上绑定端口</span>
    server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 开始监听</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        client<span class="token punctuation">,</span> address <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
        key <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            value <span class="token operator">=</span> key<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&#39;ERROR MESSAGE: </span><span class="token interpolation"><span class="token punctuation">{</span>key<span class="token punctuation">}</span></span><span class="token string">&#39;</span></span><span class="token punctuation">)</span>
            value <span class="token operator">=</span> <span class="token string">&quot;&quot;</span>
        <span class="token keyword">if</span> <span class="token string">&quot;GET / HTTP/1.1&quot;</span> <span class="token keyword">in</span> value<span class="token punctuation">:</span> <span class="token comment"># TCP连接，进入Receiver处理流程</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                Receiver <span class="token operator">=</span> WebSocket<span class="token punctuation">(</span>client<span class="token punctuation">)</span>
                Receiver<span class="token punctuation">.</span>init<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                info <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8096</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                info <span class="token operator">=</span> <span class="token string">&quot;None&quot;</span>
            body <span class="token operator">=</span> Receiver<span class="token punctuation">.</span>unpackage<span class="token punctuation">(</span>info<span class="token punctuation">)</span>
            Receiver<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">&#39;Success&#39;</span><span class="token punctuation">)</span>
            receivers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Receiver<span class="token punctuation">)</span>
            Receive_Thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>handleReceive<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>Receiver<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Receive_Thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># WebSocket连接，进入Sender处理流程</span>
            client<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">&#39;Success&#39;</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Send_Thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>handleSend<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>client<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Send_Thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-5-服务部署" tabindex="-1"><a class="header-anchor" href="#_4-5-服务部署" aria-hidden="true">#</a> 4.5 服务部署</h3><p>本文服务端采用云服务技术和容器化技术相结合的方式作为程序的部署平台。与传统部署方式相比，云服务技术和容器化技术相结合的方式具备稳定性，可拓展性，可移植性等诸多优点，是现在各个互联网服务所采用的最前沿最完善的一套解决方案。本节将分别对云服务和容器化技术做一个简要的介绍，并描述本项目在具体部署中如何结合这两种技术来组成部署平台。</p><h4 id="_4-5-1-云服务" tabindex="-1"><a class="header-anchor" href="#_4-5-1-云服务" aria-hidden="true">#</a> 4.5.1 云服务</h4><p>云服务器是一种集中的服务器资源，通过互联网托管和提供，并由多个用户按需访问。云服务器可以执行与传统物理服务器相同的所有功能，提供处理能力、存储和应用。</p><p>云服务器可以位于世界的任何地方，通过云计算环境远程提供服务。相比之下，传统的专用服务器硬件通常设置在场所内，供一个组织独家使用。</p><p>云服务器采用基础设施即服务(IaaS)模式。采用IaaS的组织不需要拥有和管理他们自己的硬件；他们可以从通过公共云按需提供资源的第三方那里提供硬件。</p><p>云服务器已经彻底改变了IT行业。无数的公司已经从传统的、集中的服务器和基础设施设置中转移出来，以适应这种改变行业规则的技术。有四个主要的优点推动了这种转变。</p><ul><li>可负担性。对公司来说，使用由第三方供应商管理的云服务器比购买和维护他们自己的基础设施要便宜得多。公司在与他人共享服务器资源时，可以从规模经济中获益，而且他们只需为他们使用的资源付费。</li><li>方便维护。公共云资源通常可以在几分钟内完成配置，并通过一个控制面板或API轻松管理。当IT团队不再需要在企业内部维护复杂的基础设施时，他们的资源就被释放出来用于其他任务。用户可以从任何地方访问数据。</li><li>可扩展性。随着计算和数据存储需求的变化，云服务器可以快速响应，扩大或缩小规模以满足需求。</li><li>可靠性。云服务器可以提供与专用服务器相同的性能。由于云在一个共享环境中的多个服务器上运行，即使一个组件出现故障，服务也可以继续。</li></ul><p><img src="/img/in-post/2022-05-13/4.7.jpg" alt="图4.7 云服务概念图"></p><blockquote><p>图4.7 云服务概念图</p></blockquote><h4 id="_4-5-2-容器化" tabindex="-1"><a class="header-anchor" href="#_4-5-2-容器化" aria-hidden="true">#</a> 4.5.2 容器化</h4><p>容器化是将软件代码与运行代码所需的操作系统库和依赖关系打包，以创建一个单一的轻量级可执行文件，即容器，并在任何基础设施上稳定运行。容器比虚拟机(VM)更便携、更节省资源，已经成为现代云原生应用事实上的部署单元。</p><p>容器化使开发人员能够更快、更安全地创建和部署应用程序。用传统的方法，代码是在一个特定的计算环境中开发的，当转移到一个新的地方时，往往会导致错误和误差。例如，当开发人员将代码从桌面计算机转移到虚拟机(VM)或从Linux转移到Windows操作系统时。容器化通过将应用程序代码与运行所需的相关配置文件、库和依赖关系捆绑在一起而消除了这个问题。这个单一的软件包或容器被从主机操作系统中抽象出来，因此，每个单独的容器都是独立的，可以在任何平台或云上运行。</p><p>容器化和流程隔离的概念实际上已有几十年的历史，但2013年开源的Docker引擎的出现<a href="#reference"><sup>[30]</sup></a>，即一个具有简单开发者工具和通用打包方法的容器行业标准加速了这项技术的采用。时至今日，越来越多的企业正使用容器化来创建新的应用程序，并为云计算对现有的应用程序进行现代化。在IBM最近的一项调查中，61%的容器使用者报告说，在过去两年中，他们建立的新应用中有50%或更多使用了容器；64%的使用者预计在未来两年中，他们现有的应用中有50%或更多被放入容器。</p><p>容器通常被称为 &quot;轻量级&quot;，所有容器共享机器的操作系统内核，不需要付出在每个应用程序中关联操作系统的开销。容器的容量比虚拟机更小，所需的启动时间也更短，在相同的计算容量上运行时，相比运行单个虚拟机，可以运行更多的容器。这推动了更高的服务器效率，反过来也降低了服务器和许可成本。</p><p>最重要的是，容器化使应用程序可以 &quot;一次编写，随处运行&quot;。这种可移植性加快了开发速度，防止云供应商锁定，并提供其他明显的好处，如故障隔离，易于管理，简化安全等(见下文)。</p><p>容器化为开发者和开发团队提供了很大的便利，在开发和生产部署过程中都有不可替代的优势，具体总结为以下内容:</p><ul><li>可移植性。容器创建了一个可执行的软件包，它脱离了主机操作系统(不绑定或依赖)，因此是可移植的，能够在任何平台或云中统一和一致地运行。</li><li>故障隔离。每个容器化的应用程序都是隔离的，并且独立于其他应用程序运行。一个容器的故障不会影响任何其他容器的继续运行。开发团队可以在一个容器内识别和纠正任何技术问题，而不需要在其他容器内进行任何停机。另外，容器引擎可以利用任何操作系统的安全隔离技术--如SELinux访问控制--来隔离容器内的故障。</li><li>易于管理。容器编排平台可以自动安装、扩展和管理容器化工作负载和服务。容器协调平台可以减轻管理任务，如扩展容器化应用程序，推出应用程序的新版本，并提供监控、日志和调试等功能。Kubernetes<a href="#reference"><sup>[31]</sup></a>，也许是目前最流行的容器编排系统，是一项开源技术(最初由谷歌开源，基于他们的内部项目Borg)，最初将Linux容器功能自动化。Kubernetes与许多容器引擎一起工作，如Docker，但它也与任何符合开放容器倡议(OCI)标准的容器镜像格式和运行时间的容器系统一起工作。</li><li>安全性。作为容器的应用程序的隔离本身就可以防止恶意代码的入侵影响其他容器或主机系统。此外，可以定义安全权限，以自动阻止不需要的组件进入容器或限制与不必要的资源的通信。</li></ul><h4 id="_4-5-3-云服务和容器化技术协同部署" tabindex="-1"><a class="header-anchor" href="#_4-5-3-云服务和容器化技术协同部署" aria-hidden="true">#</a> 4.5.3 云服务和容器化技术协同部署</h4><p>基于以上优点以及行业趋势，本文中服务器采用腾讯云提供的通用性轻量应用服务器。规格是CPU 1核心，内存2GB，系统盘60G SSD，带宽6Mbps。具有价格低，网络带宽大，性能合格，系统和网络稳定可靠的优点。</p><p>并且本文在云服务的基础上将服务器程序容器化，本文使用的容器引擎是Docker容器。</p><p>使用Docker容器将服务器程序程序整体封装成一个单一的可执行软件包，将应用程序代码与所有相关的配置文件、库和运行所需的依赖性捆绑在一起。这确保了服务运行的环境稳定性并进一步确保了整体服务的稳定运行。</p><h2 id="第5章-软件系统设计" tabindex="-1"><a class="header-anchor" href="#第5章-软件系统设计" aria-hidden="true">#</a> 第5章 软件系统设计</h2><blockquote><p>软件系统代码 - <a href="https://github.com/louisyoungx/pulse-connect-analyse" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/pulse-connect-analyse</a></p></blockquote><h3 id="_5-1-软件系统设计概述" tabindex="-1"><a class="header-anchor" href="#_5-1-软件系统设计概述" aria-hidden="true">#</a> 5.1 软件系统设计概述</h3><p>本章详述了智能手机APP的软件设计，首先介绍了Web开发技术，并介绍了锁采用的关键技术。然后介绍了软件总体架构设计，以及APP的各部分界面设计进行了详细介绍，最后介绍了软件系统中最核心的部分，即对脉搏数据流的处理与特征算法介绍。</p><h3 id="_5-2-技术选型与原因" tabindex="-1"><a class="header-anchor" href="#_5-2-技术选型与原因" aria-hidden="true">#</a> 5.2 技术选型与原因</h3><p>Web开发技术是现在最流行的跨平台开发技术，本文项目采用现代Web开发技术来达到跨平台的目的。因此本节将简要Web开发技术和现代Web开发技术，并基于此例举了本文的技术选型。</p><h4 id="_5-2-1-web开发技术简介" tabindex="-1"><a class="header-anchor" href="#_5-2-1-web开发技术简介" aria-hidden="true">#</a> 5.2.1 Web开发技术简介</h4><p>Web技术是一项面向网站，应用程序与客户端的开发技术。相比于原生开发技术如iOS和Android开发技术，Web技术可以运行在所有平台上，包括常见的Windows、MacOS、Linux、iOS和Android，因此Web技术被广泛用于开发跨平台应用。</p><p>Web开发基于三个关键技术，HTML、CSS、JavaScript。HTML是超文本标记语言的缩写，是网络开发所需的基本技术之一，为应用提供基础结构。CSS为层叠样式表的缩写，定义了基于HTML结构的各个元素外观，包括应用页面布局、颜色、字体和元素定位。JavaScript是Web开发的标准编程语言，可以让静态的应用变成可以交互的动态应用。</p><h4 id="_5-2-2-现代web开发技术" tabindex="-1"><a class="header-anchor" href="#_5-2-2-现代web开发技术" aria-hidden="true">#</a> 5.2.2 现代Web开发技术</h4><p>原生JavaScript有很大的局限性，现代基于WebPack和NPM的JavaScript的生态比编程语言本身更重要，各种JavaScript的框架和库通过提供工具，平台和语法大大简化了开发工作的繁琐性。因此在现代Web开发中常常使用三个最受欢迎的JavaScript框架进行开发，分别是Vue、React、Angular<a href="#reference"><sup>[32]</sup></a>。本文项目中使用Vue进行开发。</p><p>Vue是一个开源的渐进式框架，主要用于构建网页界面和单页应用程序，渐进式框架这一概念来自于Vue被设计成可逐步渐进学习或使用。Vue可以非常便捷地开发复杂的单页应用程序，在编写应用程序时，Vue提供的数据绑定和数据驱动的开发方式相比于传统开发方式直接处理DOM(Document Object Model)来说更直观更高效。</p><p>Vue的优点有:</p><ol><li>轻量级。Vue包大小仅18KB。</li><li>上手简单。学习Angular或React库需要非常了解JSX或TypeScript。Vue只需要了解是HTML、CSS和JavaScript方面的基本知识。</li><li>有完整的工具链。Vue有一套强大的端到端开发测试的工具，包括插件管理系统Vite、浏览器调试工具devtools、服务端渲染Nuxt、状态管理工具VueX、路由管理Vue-Router。</li></ol><h4 id="_5-2-3-技术选型" tabindex="-1"><a class="header-anchor" href="#_5-2-3-技术选型" aria-hidden="true">#</a> 5.2.3 技术选型</h4><p>综上所述，本文项目出于跨平台的原因选用Web技术对应用程序进行开发，最终APP不仅可以运行在Web浏览器，还能运行在iOS、Android等移动平台。并且考虑到技术的先进性，采用了现在最前沿的Web开发技术。</p><p>本项目采用现代Web开发技术进行开发。包管理器是最主流的NPM，打包器是目前最流行的WebPack。主体JavaScript框架是Vue；状态管理工具选用VueX；路由管理选用Vue-Router；考虑到脉搏信号需要实时绘制，采用功能完善的重量级图表库ECharts作为插件；考虑到UI的现代性，采用Vant作为主题UI框架。</p><h3 id="_5-3-软件架构设计" tabindex="-1"><a class="header-anchor" href="#_5-3-软件架构设计" aria-hidden="true">#</a> 5.3 软件架构设计</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token builtin class-name">.</span>
├── package.json
├── node_modules
├── public
├── src
│   ├── App.vue
│   ├── components
│   ├── main.js
│   ├── router.js
│   ├── store.js
│   └── views
│       ├── home.vue
│       ├── chart.vue
│       ├── settings.vue
│       └── user.vue
└── README.md
</code></pre></div><p>由于采用WebPack打包工具，所有本项目架构分布为标准WebPack文件组织方式。</p><p>public目录存放不会被WebPack打包的静态文件，如图片，静态页面模版，manifest.json网站描述，robots.txt爬虫规则限制。</p><p>README.md文件中是本项目的详细描述以及如何部署代码，及对应的使用方法。</p><p>package.json中存放了描述，NPM管理包的描述与运行打包所需运行的命令。在scripts项中的start是启动开发服务器的选项，build是构建开发服务器的选项；dependencies中是包依赖，其中安装了本文技术选型中所罗列的依赖包，包括vant、echarts、vue、vue-router、vuex。devDependencies是开发包依赖，其中安装了开发时所需的辅助依赖包。所有第三方依赖包都是用NPM安装在node_modules目录中。</p><div class="language-json ext-json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pulse-connect-analyse&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.2.0&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service serve&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vue-cli-service build --report&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;echarts&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vant&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.4.8&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.2.33&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vue-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.14&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;vuex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^4.0.2&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;devDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;@vue/cli-plugin-babel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;~4.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-pwa&quot;</span><span class="token operator">:</span> <span class="token string">&quot;~4.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-router&quot;</span><span class="token operator">:</span> <span class="token string">&quot;~4.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-plugin-vuex&quot;</span><span class="token operator">:</span> <span class="token string">&quot;~4.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/cli-service&quot;</span><span class="token operator">:</span> <span class="token string">&quot;~4.5.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;@vue/compiler-sfc&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;compression-webpack-plugin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.1.12&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sass&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^1.27.0&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;sass-loader&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^10.0.4&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>src目录是WebPack的打包入口，内部存放的都是开发文件，需要经过WebPack打包。</p><p>store.js是状态管理定义文件，其中定义了所有全局持久化状态。</p><p>router.js是路由定义文件，其中存放了路由定义文件，在次文件中定义了各页面所处路径。</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHashHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
<span class="token keyword">import</span> home <span class="token keyword">from</span> <span class="token string">&#39;@/views/home/index&#39;</span>

<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">&#39;/home&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/home&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;home&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> home
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/chart&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;chart&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">&#39;@/views/chart/index&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/user&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;user&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">&quot;@/views/user/index&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&#39;/settings&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;settings&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> <span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">&quot;@/views/settings/index&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">history</span><span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> router
</code></pre></div><p>App.vue是Vue主视图的打包入口，在其中引入了路由视图作为主视图。views目录中存放Vue开发的所有子视图；home.vue定义了主页界面；chart.vue定义了实时图表界面；settings.vue定义了设置界面；user.vue定义了用户界面。components目录是视图开发中所用到的通用组件所存放的位置。</p><p>main.js是全局包引入文件，是WebPack在src目录的打包入口，从次文件中通过ESM(ECMA Script Module)引入了以上提到的路由、状态管理、UI组件库，并在最后使用Vue包的createApp函数创建一个Vue实例，并挂载上引入的Module。</p><div class="language-javascript ext-js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;./App.vue&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">&#39;./router&#39;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&#39;./store&#39;</span>
<span class="token keyword">import</span> vant <span class="token keyword">from</span> <span class="token string">&#39;vant&#39;</span>
<span class="token keyword">import</span> <span class="token string">&#39;vant/lib/index.css&#39;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token constant">PCA</span> <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">PCA</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>vant<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_5-4-软件主要界面" tabindex="-1"><a class="header-anchor" href="#_5-4-软件主要界面" aria-hidden="true">#</a> 5.4 软件主要界面</h3><p>软件部分的主要界面分别是负责历史数据管理和复现的主页界面，负责实时记录显示的图表界面，负责管理全局配置的设置界面。本节将逐一描述各界面运行流程与原理。</p><h4 id="_5-4-1-主页界面" tabindex="-1"><a class="header-anchor" href="#_5-4-1-主页界面" aria-hidden="true">#</a> 5.4.1 主页界面</h4><blockquote><p>主页代码 - <a href="https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/home/index.vue" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/home/index.vue</a></p></blockquote><p>主页的主要功能有浏览存储的历史数据列表，对历史数据的操作选项，对历史数据的回放选项。因此基于以上功能进行页面设计，主页页面上分为上下两部分，上半部分为图表，下半部分根据功能变化。在浏览存储的历史数据列表时显示历史数据，对历史数据的回放切换到特征数据显示和回放暂停等按钮的显示。这个页面显示的切换依赖于一个isPlayback页面状态变量。</p><p><img src="/img/in-post/2022-05-13/5.1.jpg" alt="图5.1 存储的历史数据列表"></p><blockquote><p>图5.1 存储的历史数据列表</p></blockquote><p>存储的历史数据列表中的数据来自于负责实时记录显示的图表界面如图5.1所示，这依赖于VueX状态管理实现。在store.js状态管理中定义了一个recording列表负责存储历史数据，每条历史数据都是一个JavaScript对象，拥有name、record、startTime、endTime四个键。name是每条数据的唯一标识符，负责区分数据；record为脉搏数据的记录列表；startTime与endTime为开始时间和结束时间，主要用于时长显示和回放时的时间轴刻度显示。</p><p><img src="/img/in-post/2022-05-13/5.2.jpg" alt="图5.2 历史数据的操作选项"></p><blockquote><p>图5.2 历史数据的操作选项</p></blockquote><p>历史数据的操作选项包括回放和删除如图5.2所示。这涉及recording历史数据列表的索引查询，因此在每次调用回放函数startPlayback()和删除函数recordingDelete()时都需传入该条数据所处的索引。回放操作即把记录对象的record列表中的脉搏数据放入display执行栈中，并把页面状态isPlayback切换到true。删除操作即移除recording列表中索引处的记录。</p><p><img src="/img/in-post/2022-05-13/5.3.jpg" alt="图5.3 历史数据的回放"></p><blockquote><p>图5.3 历史数据的回放</p></blockquote><p>历史数据的回放与复现如图5.3所示)。回放功能有关闭、暂停、重播的选项，这些功能都基于对数据流处理实现，具体将在5.5节中详细介绍。</p><p>图中心跳定义是数据窗口内的心跳次数，数据宽度120，频率10HZ，说明数据列表中的时间长度是12秒，在12秒内发生了20次心跳，等价于在60秒内会发生100次心跳。</p><h4 id="_5-4-2-图表界面" tabindex="-1"><a class="header-anchor" href="#_5-4-2-图表界面" aria-hidden="true">#</a> 5.4.2 图表界面</h4><blockquote><p>图表界面代码 - <a href="https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/chart/index.vue" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/chart/index.vue</a></p></blockquote><p>图表界面负责从服务器接收实时脉搏数据，并将数据绘制成实时脉搏波形，调用5.5节中讲述的脉搏数据处理模块对特征值进行计算，并将特征值绘制到脉搏波形图上。图表界面由上下两部分组成，上半部分是负责显示波形和特征点的图表，下半部分是显示特征数据的界面，根据对脉搏波形数据的处理和计算，能从中获取出脉搏波的频率、幅值、心跳次数、心率等特征并进行实时显示，同时也显示服务器和特征选项的一些信息。</p><p><img src="/img/in-post/2022-05-13/5.4.jpg" alt="图5.4 图表界面"></p><blockquote><p>图5.4 图表界面</p></blockquote><p>由于移动端APP的图形性能限制，本文对图表界面做了性能优化，即图表的处理采取了图表数据处理和图表显示更新分离的方式。图表的数据处理即每次从WebSocket获取到脉搏数据，加入到脉搏数据列表中并计算脉搏特征的操作。而本文根据对移动端APP的图形性能的研究发现，移动端APP的图形性能并不足以支撑每次更新数据都同步进行一次图表更新，这是因为图表的更新相当于是对图表的重新绘制，需要消耗大量的图形计算算力，因此在短时间内对图表进行多次更新会造成APP的延迟与卡顿，在数据频率大的情况下甚至会造成APP失去响应，即宕机。</p><p>另外本文还发现，不同移动端APP的浮点数计算能力有很大差异，因此脉搏列表的数据量，即每次参与计算所需的脉搏节点数量，也对APP性能有很大影响。</p><p>针对以上情况，需要在APP中对图表更新频率作出限制，对此新增了三个参数来控制图表的刷新速率与脉搏列表的数据量，分别是width(数据宽度)、number(图表单次更新节点个数)、flash(图表更新时间)。通过width可以限制脉搏列表的数据量与图表宽度；number需要与发送端同步，为每次更新的脉搏节点个数；flash为图表刷新时间，以毫秒为单位。</p><h4 id="_5-4-3-设置界面" tabindex="-1"><a class="header-anchor" href="#_5-4-3-设置界面" aria-hidden="true">#</a> 5.4.3 设置界面</h4><blockquote><p>设置界面代码 - <a href="https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/settings/Settings.vue" target="_blank" rel="noopener noreferrer">https://github.com/louisyoungx/pulse-connect-analyse/blob/master/src/views/settings/Settings.vue</a></p></blockquote><p>在设置界面可以对数据显示宽度，单次更新个数，更新间隔时间，是否显示特征值，是否启动动画，服务器域名/IP，服务器端口等进行配置。</p><p><img src="/img/in-post/2022-05-13/5.5.jpg" alt="图5.5 设置界面"></p><blockquote><p>图5.5 设置界面</p></blockquote><p>由于Vue组件存在作用域，组件作用域内的变量仅限组件内以及自组件可访问，并且变量的生命周期会在组件销毁后结束，无法持久化保存，因此设置界面功能实现依赖于VueX状态管理并进行持久化支持。VueX规定组件无法直接修改state，因此需要通过mutations对操作进行定义，本文实现的保存方式是在用户点击保存按钮后，将组件内变量通过VueX的mutations操作saveSettings()函数保存到VueX到state内。</p><h3 id="_5-5-脉搏数据处理与显示" tabindex="-1"><a class="header-anchor" href="#_5-5-脉搏数据处理与显示" aria-hidden="true">#</a> 5.5 脉搏数据处理与显示</h3><p>脉搏数据的处理与显示流程需要经历对数据的初始化，对图表的实例化，与服务器建立WebSocket连接并开始接受数据流，对数据流进行预处理，并进行数据特征计算。</p><h4 id="_5-5-1-数据初始化" tabindex="-1"><a class="header-anchor" href="#_5-5-1-数据初始化" aria-hidden="true">#</a> 5.5.1 数据初始化</h4><p>数据初始化用到了Vue提供的created生命周期钩子，这代表所有初始化操作都是在组件实例初始化完毕且虚拟DOM被渲染成真实DOM之前进行操作。这是由ECharts图表特性决定的，一旦真实DOM渲染完毕意味着图表宽度和特征值这类数据已经固定了，因此图表宽度和特征值这类数据需要在此之前就获取完毕，所以所有数据初始化操作都需要在图表初始化之前完成，即在created生命周期钩子内完成。</p><p>在created生命周期内主要做两件事，一是从VueX的state中获取设置数据，二是针对各个设置数据进行预处理。因此created生命周期主要完成如下步骤:</p><ol><li>从state状态管理中将数据显示宽度，单次更新个数，更新间隔时间，是否显示特征值，是否启动动画，服务器域名/IP，服务器端口等数据读入内存之中待用。</li><li>将数据显示宽度，单次更新个数，更新间隔时间的类型从字符串转为数字。</li><li>将域名和端口拼接为可用网络地址。</li><li>根据特征值是否开启选项对图表选项进行初始化设置。</li></ol><h4 id="_5-5-2-图表实例化" tabindex="-1"><a class="header-anchor" href="#_5-5-2-图表实例化" aria-hidden="true">#</a> 5.5.2 图表实例化</h4><p>图表实例化用到了Vue提供的mounted生命周期钩子，这代表此时的虚拟DOM已经被渲染成真实DOM，也因此ECharts图表才可以根据真实DOM进行挂载，即初始化ECharts图表实例。因此mounted生命周期主要完成如下步骤:</p><ol><li>按需引入echarts主模块、折线图、提示框和标题组件。</li><li>并基于准备好的dom，初始化echarts实例。</li><li>根据之前读入的数据显示宽度，进行数据填充，向脉搏列表中推入幅值为0的初始化数据。</li><li>图表实例化完成后，调用主函数进入WebSocket连接与数据流预处理的流程。</li></ol><h4 id="_5-5-3-建立websocket连接与数据流预处理" tabindex="-1"><a class="header-anchor" href="#_5-5-3-建立websocket连接与数据流预处理" aria-hidden="true">#</a> 5.5.3 建立WebSocket连接与数据流预处理</h4><p>WebSocket连接与数据流预处理是在主函数流程中，即完成数据初始化和图表实例化之后。首先程序将会使用之前准备好的服务器地址，并实例化一个WebSocket连接对象，并对此连接进行监听，一旦接收到event，即对此event中的脉搏数据进行预处理，即形成一个数据流的预处理。预处理包括如下步骤:</p><ol><li>判断是否是首次连接，如果是拿到第一个数据，将该数据填充到图表中。</li><li>判断当前是否处于录制状态，若处于录制状态，将脉搏数据添加进录制记录列表中。</li><li>对当前秒数进行叠加，根据总时间计算当前数据发送频率。</li><li>将数据推入脉搏数据列表中，并向时间轴推入当前时间。</li><li>调用脉搏特征计算的流程。</li></ol><h4 id="_5-5-4-脉搏特征计算" tabindex="-1"><a class="header-anchor" href="#_5-5-4-脉搏特征计算" aria-hidden="true">#</a> 5.5.4 脉搏特征计算</h4><p>本节将简要介绍脉搏特征计算带有的数据预处理算法FIR滤波器和峰值检测方法。</p><p>针对离散时间的数字信号N阶滤波器，输出序列的每一个值都是最近输入的加权和:</p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">]</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span></p><p>其中</p><ul><li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>是输入信号</li><li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span></span></span></span>是输出信号</li><li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>是滤波器阶数。<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span>阶滤波器表示在右边有<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>项</li><li><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span></span>阶FIR滤波器在第<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>时间(<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7955em;vertical-align:-0.136em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>)的脉冲响应。若滤波器是直接型的FIR滤波器，则<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>也就是滤波器的系数。</li></ul><p>计算也称为离散卷积。</p><p>上述项中的<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span>常称为tap(抽头)，依数字延迟线的结构而定，在许多实现或方块图中，会将延迟输入进行乘法运算。</p><p>滤波器的冲激响应定义为有限区间内的非零值。包括零值在内，冲激响应是无限数列:</p><p><span class="katex-display"><span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.106em;vertical-align:-1.2777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">其他情况</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>若FIR滤波器是非因果的，其冲激响应上的非零值范围可能从<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>前就开始。</p><p>FIR滤波器有以下的优点:</p><ul><li>不需要反馈，因此舍去误差不会因为连续的加总而累计。每一次的计算其相对误差都是一样的，因此在实现上比较简单。</li><li>稳定，因为其输出是有限个输入值乘以有限倍数的和，因此不会大于<span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>乘以输入的最大值。</li></ul><p>FIR滤波器的主要缺点是在CPU上的运算量大。</p><p>峰值检测使用一个自适应阈值以适应脉搏波形的形态和振幅变化，然后进行离群点检测和剔除。为了识别心跳，在每个数据点的两边用一个心跳周期长度的窗口来计算窗口中振幅的平均值。并在信号振幅大于移动平均值的区间内进行峰值寻找，此处有两种获得峰值位置的方法。在第一种方法中，峰值位置被简单地认为是寻找区间中的最高点，这个办法的计算步骤很少，因此计算很快，但其准确性取决于信号的采样率，采样率越高，结果越准确。第二种方法是对区间内的信号使用曲线光滑处理来采样和插值，然后对处理后的信号求出最大值，这比方法一计算量更大，但这种方法即使在低采样率的情况下也很准确。出于移动端计算性能的考虑，在本文中采取方法一。</p><h2 id="第6章-结论与展望" tabindex="-1"><a class="header-anchor" href="#第6章-结论与展望" aria-hidden="true">#</a> 第6章 结论与展望</h2><p>本文开篇简要阐述了智能生命体征监测设备发展的必要性，介绍了国内外生命体征监测技术的研究现状。接下来脉搏波测量原理。介绍了脉搏波产生的机理与波形特征，阐述了其各自的成因、重要性和测量方法，基于弯曲光纤传感器的脉搏测量方法。然后简要讲述了光纤脉搏传感系统的设计。详细介绍了项目中服务器架构，服务与部署，各服务的原理与设计原因，并简略介绍云服务技术与容器化技术的设计和优势。最后重点介绍了APP的软件系统设计，详述了智能手机APP的软件设计，介绍了Web开发技术以及采用的关键技术，并对APP的各部分界面设计以及脉搏数据流的处理与特征算法进行了详细描述。</p><p>在APP的主页历史数据的选项中预留了插件拓展位，通过此处可以很便捷地为APP添加新的脉搏数据分析方法。在服务器中通过Turbon框架的支持，可以很方便地添加新的扩展API，并且Python语言天然可以引入很多科学计算的包，可以对客户端上传的数据进行分析。</p><p>本项目的未来工作有以下几个方向:</p><ol><li>在JavaScript上实现SVM向量机预测脉搏波流速PWV和动态血压值ABP。</li><li>在服务器端使用Python深度学习进行脉搏疾病分类，使用MIMIC疾病数据库作为训练数据集。</li><li>在JavaScript实现心跳间隔测量，并根据呼吸时的心率变化来预测呼吸频率。</li></ol><div id="reference"></div><h2 id="参考文献" tabindex="-1"><a class="header-anchor" href="#参考文献" aria-hidden="true">#</a> 参考文献</h2><ul><li>[1] W. H. Organization et al., World Health Statistic 2020. Organization, 2020.</li><li>[2] World Health Organization The Top 10 Causes of Death. 2019.</li><li>[3] 胡生寿.中国心血管健康与疾病报告2019概要[J].中国循环杂志,2020,35(9):833-854.</li><li>[4] 黄丽卿。基于光电容积脉搏波的心率变异度检测方法研究[D]。北京，北京工业大学，2013。</li><li>[5] 肖登，万生鹏，尹玺，刘恒，熊新中，张思军。“基于弯曲光纤传感头的脉搏采集系统，”激光与光电子学进展，2021，58(05):119-125。</li><li>[6] World Health Organization . mHealth: New Horizons for Health through Mobile Technologies. World Health Organization; Geneva, Switzerland: 2011.</li><li>[7] 中国心血管健康与疾病报告编写组。中国心血管健康与疾病报 2019 概要[J]。心脑血管病防治，2020,20(5):437-450.</li><li>[8] M. F. ORourke and J. Hashimoto, “Mechanical factors in arterial aging: A clinical perspective,” J. Am. Coll. Cardiol., vol. 50, no. 1, pp. 1 – 13, 2007.</li><li>[9] Primary Expert Committee on Hypertension Management, “The 2017 Chinese guidelines for the management of hyperten- sion,” Chinese Circulation Journal, vol. 32, pp. 1041–1048, 2017.</li><li>[10] 罗志昌, 张松, 杨益民. 脉搏波工程分析与临床应用[M].北京:科学出版社,2006(05):18-20.</li><li>[11] Shin, H.; Min, S.D. Feasibility study for the non-invasive blood pressure estimation based on ppg morphology: Normotensive subject study. Biomed. Eng. Online 2017, 16, 1–14.</li><li>[12] Sun. G, Takemi.M, Yasuyuki.W, et al. Vital-SCOPE: Design and Evaluation of a Smart Vital Sign Monitor for Simultaneous Measurement of Pulse Rate, Respiratory Rate, and Body Temperature for Patient Monitoring[J]. Journal of Sensors,2018, 2018:1-7.</li><li>[13] 罗志昌, 张松, 杨文鸣, 杨子彬. 脉搏波波形特征信息的研究[J].北京工业大学学 报,1996(01):71-79.</li><li>[14] Elgendi, M.; Liang, Y.; Ward, R. Toward Generating More Diagnostic Features from Photoplethysmogram Waveforms. Diseases 2018, 6, 20.</li><li>[15] Kunze.C, Grossmann.U, Stork.W, et al. Application of ubiquitous computing in personal health monitoring system[J]. Biomedizinische Technik. Biomedical engineering,2002,47 supply 1Pt 1:360-362.</li><li>[16] Willem Einthoven. Die galvanometrisehe Registrirung des mensehlichen Elektrokardiogramms, zu- gleich eine Beurtheilung tier Anwendung des Capillar-Elektrometers in tier Physiologiel. PhysiologischesLaboratorium in Leyden, 1903.</li><li>[17] Cooper, J. K. Electrocardiography 100 years ago. Origins, pioneers, and contributors. The New England Journal of Medicine. 1986.</li><li>[18] Hilbel, Thomas; Thomas M Helms; Gerd Mikus; Hugo A Katus; Christian Zugck. Telemetry in the clinical setting. Herzschrittmachertherapie &amp; Elektrophysiologie. 2008.</li><li>[19] F. S. Cattivelli and H. Garudadri, “Noninvasive cuffless estimation of blood pressure from pulse arrival time and heart rate with adaptive calibration,” in Wearable and Implantable Body Sensor Networks, 2009. BSN 2009. Sixth International Workshop on. IEEE, 2009, pp. 114–119.</li><li>[20] 曹奕涛, 淳莉, 邹富强. 基于无线传感器网络的脉搏波形采集和辅助诊断系统[J].物联网 技术,2016,6(05):85-88+9366</li><li>[21] 凌建东. 基于脉搏波的人体健康监护系统研究[D].哈尔滨理工大学,2018.</li><li>[22] 邓猛. 基于智能手机的脉搏信号检测与监护系统[D].东南大学,2018.</li><li>[23] 赵毅飞. 基于 Android 可穿戴生理参数检测系统的设计与实现[D].长春理工大学,2021.</li><li>[24] Leitão.C, Antunes.P, André.P, et al. Central arterial pulse waveform acquisition with a portable penlike opticalfiber sensor[J]. Blood Pressure Monitoring,2015,20(1):43-46.</li><li>[25] 张宇彤. 基于脉搏检测的人体健康状况分析与诊断系统[D].2019,兰州交通大学.</li><li>[26] 王雪, 王锡芝, 辛圣杰. 光纤传感技术的制造与应用[J].集成电路应用,2022,39(01):248-249.</li><li>[27] Shaohua Wang, Iman Keivanloo, Ying Zou. How Do Developers React to RESTful API Evolution. Service-Oriented Computing. 2014.</li><li>[28] Marina del Rey. Transmission Control protocol. Information Sciences Institute, University of Southern California, September 1981.</li><li>[29] Google, Inc. The WebSocket Protocol. Internet Engineering Task Force, December 2011.</li><li>[30] Charles Anderson. Docker [Software engineering]. IEEE Software, 2015.</li><li>[31] Jay Shah, Dushyant Dubaria. Building Modern Clouds: Using Docker, Kubernetes &amp; Google Cloud Platform. IEEE (CCWC), March 2019.</li><li>[32] 李洁.主流 JavaScript 框架-Angular、React 和 Vue 使用体会[J].电脑迷，2019,01(01):85.</li></ul><h2 id="致谢" tabindex="-1"><a class="header-anchor" href="#致谢" aria-hidden="true">#</a> 致谢</h2><p>在光电专业学习是一个不断试错、不断前进的过程。实际上，我刚经历大一入学学习是很不顺利的，面临着学习方法，学习环境，目标改变带来的困惑和压力，也有跟不上理科课程而对自己信心的打击。</p><p>但当想要放弃的时候，这又如何不是对自己的考验呢，完善与提升自己不就是不断战胜自己的过程么。我逐渐尝试参加进学院的创新创业和科研活动。</p><p>万生鹏老师指引我进实验室，完成基于光纤传感的脉搏测量项目的跨平台应用“脉搏悦动”与对不同协议适配转换的服务器端架构设计。朱泉水老师引导我构思和完成物联网三小项目“基于树莓派的云端智能锁”。陈果老师帮助我参与到学院工作的建设，完成了学院挂科学生课业帮扶系统的前后端搭建，完成了学院青年大学习未做通知和新冠疫情未打卡名单这些自动化项目，而且很荣幸拿到了学院“技术顾问”的称号。</p><p>对于我来说，本科学习期间期间提升最大的就是发现问题并解决问题的能力，这个过程虽然很艰难，但是所有的付出终究会有所收获。</p><p>最后，我也很感谢学校中很多优秀的老师和同学们给予我的帮助和支持。</p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><svg class="ov-icon" style="font-size:1.08em;" aria-hidden="true" width="17.28" height="17.28" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg><a class="external-link meta-item-label" href="https://github.com/louisyoungx/louisyoungx.github.io/edit/master/blog/posts/2022-05-13-human-vitals-feature-mobile-application.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--><!----><span>Edit this page on GitHub</span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><!----></footer><!----><!--[--><!--]--><!----></main><ul class="catalog" style="top:0px;"><li class="level-2 toc-link-摘要">摘要</li><li class="level-2 toc-link-abstract">Abstract</li><li class="level-2 toc-link-第1章-引言">第1章 引言</li><li class="level-3 toc-link-_1-1-前言">1.1 前言</li><li class="level-3 toc-link-_1-2-研究背景及意义">1.2 研究背景及意义</li><li class="level-3 toc-link-_1-3-国内外研究现状">1.3 国内外研究现状</li><li class="level-3 toc-link-_1-4-论文研究内容与结构安排">1.4 论文研究内容与结构安排</li><li class="level-2 toc-link-第2章-脉搏波测量原理">第2章 脉搏波测量原理</li><li class="level-3 toc-link-_2-1-心电系统和脉搏波的产生原理">2.1 心电系统和脉搏波的产生原理</li><li class="level-3 toc-link-_2-2-脉搏波特征点的意义">2.2 脉搏波特征点的意义</li><li class="level-3 toc-link-_2-3-ecg和ppg心电信号图">2.3 ECG和PPG心电信号图</li><li class="level-3 toc-link-_2-4-基于弯曲光纤传感器的脉搏测量方法">2.4 基于弯曲光纤传感器的脉搏测量方法</li><li class="level-3 toc-link-_2-5-本章小结">2.5 本章小结</li><li class="level-2 toc-link-第3章-光纤脉搏传感系统">第3章 光纤脉搏传感系统</li><li class="level-3 toc-link-_3-1-光纤脉搏传感系统简介">3.1 光纤脉搏传感系统简介</li><li class="level-3 toc-link-_3-2-信号采集系统">3.2 信号采集系统</li><li class="level-4 toc-link-_3-2-1-半导体光源">3.2.1 半导体光源</li><li class="level-4 toc-link-_3-2-2-弯曲光纤传感头">3.2.2 弯曲光纤传感头</li><li class="level-4 toc-link-_3-2-3-光电探测器">3.2.3 光电探测器</li><li class="level-3 toc-link-_3-3-信号处理系统">3.3 信号处理系统</li><li class="level-3 toc-link-_3-4-本章小节">3.4 本章小节</li><li class="level-2 toc-link-第4章-服务器架构-服务与部署">第4章 服务器架构，服务与部署</li><li class="level-3 toc-link-_4-1-服务器架构概述">4.1 服务器架构概述</li><li class="level-3 toc-link-_4-2-基础架构">4.2 基础架构</li><li class="level-3 toc-link-_4-3-api服务">4.3 API服务</li><li class="level-3 toc-link-_4-4-协议转换与转发服务">4.4 协议转换与转发服务</li><li class="level-4 toc-link-_4-4-1-tcp协议">4.4.1 TCP协议</li><li class="level-4 toc-link-_4-4-2-websocket协议">4.4.2 WebSocket协议</li><li class="level-4 toc-link-_4-4-3-并发连接与转发">4.4.3 并发连接与转发</li><li class="level-4 toc-link-_4-4-4-服务器转发运行流程">4.4.4 服务器转发运行流程</li><li class="level-3 toc-link-_4-5-服务部署">4.5 服务部署</li><li class="level-4 toc-link-_4-5-1-云服务">4.5.1 云服务</li><li class="level-4 toc-link-_4-5-2-容器化">4.5.2 容器化</li><li class="level-4 toc-link-_4-5-3-云服务和容器化技术协同部署">4.5.3 云服务和容器化技术协同部署</li><li class="level-2 toc-link-第5章-软件系统设计">第5章 软件系统设计</li><li class="level-3 toc-link-_5-1-软件系统设计概述">5.1 软件系统设计概述</li><li class="level-3 toc-link-_5-2-技术选型与原因">5.2 技术选型与原因</li><li class="level-4 toc-link-_5-2-1-web开发技术简介">5.2.1 Web开发技术简介</li><li class="level-4 toc-link-_5-2-2-现代web开发技术">5.2.2 现代Web开发技术</li><li class="level-4 toc-link-_5-2-3-技术选型">5.2.3 技术选型</li><li class="level-3 toc-link-_5-3-软件架构设计">5.3 软件架构设计</li><li class="level-3 toc-link-_5-4-软件主要界面">5.4 软件主要界面</li><li class="level-4 toc-link-_5-4-1-主页界面">5.4.1 主页界面</li><li class="level-4 toc-link-_5-4-2-图表界面">5.4.2 图表界面</li><li class="level-4 toc-link-_5-4-3-设置界面">5.4.3 设置界面</li><li class="level-3 toc-link-_5-5-脉搏数据处理与显示">5.5 脉搏数据处理与显示</li><li class="level-4 toc-link-_5-5-1-数据初始化">5.5.1 数据初始化</li><li class="level-4 toc-link-_5-5-2-图表实例化">5.5.2 图表实例化</li><li class="level-4 toc-link-_5-5-3-建立websocket连接与数据流预处理">5.5.3 建立WebSocket连接与数据流预处理</li><li class="level-4 toc-link-_5-5-4-脉搏特征计算">5.5.4 脉搏特征计算</li><li class="level-2 toc-link-第6章-结论与展望">第6章 结论与展望</li><li class="level-2 toc-link-参考文献">参考文献</li><li class="level-2 toc-link-致谢">致谢</li></ul></div><!--]--></div><div class="search-page" role="search"><span class="search-close"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512" width="28" height="28" fill="currentColor"><path d="M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"></path></svg></span><div class="gungnir-search-box"><input placeholder="$ grep ..." autocomplete="off" spellcheck="false" value><!----></div></div><div class="menu-btn-container"><div class="menu-btn-wrapper"><div class="menu-btn"><div style="" class="menu-btn-icon"><span></span><span></span><span></span></div><div style="display:none;" class="menu-text">0</div><svg class="menu-progress"><circle class="menu-border" cx="50%" cy="50%" r="48%" style="stroke-dasharray:0% 314.15926%;"></circle></svg></div><div class="menu-btn-child-wrapper"><div class="toggle-dark-button menu-btn-child" title="toggle dark mode"><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"/></svg><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 00283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"/></svg><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.7999999999999998em;" aria-hidden="true" width="28.799999999999997" height="28.799999999999997" viewbox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div><div class="menu-btn-child menu-toc-btn"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div><div class="toggle-sidebar-button menu-btn-child menu-btn-sidebar" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewbox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div><footer class="footer"><span>
      &copy; <a href="https://github.com/louisyoungx" target="_blank">louisyoungx</a> 2018-2022
      <br>
      Powered by <a href="https://v2.vuepress.vuejs.org" target="_blank">VuePress</a> &
      <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>
    </span></footer></div><!--]--></div>
    <script type="module" src="/assets/app.f5ce6765.js" defer></script>
  </body>
</html>
